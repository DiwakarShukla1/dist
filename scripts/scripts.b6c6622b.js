"use strict";angular.module("dashboardApp",["ui.router","ng-polymer-elements","pasvaz.bindonce","ngQuickDate","google-maps","angular-intro","ngProgress"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/signin"),a.state("signin",{url:"/signin",templateUrl:"views/signin.html",controller:"SigninCtrl"}).state("signup",{url:"/changepassword",templateUrl:"views/signup.html",controller:"SignupCtrl"}).state("loading",{url:"/loading",templateUrl:"views/loading.html",controller:"LoadingCtrl"}).state("state1",{url:"/farmer",templateUrl:"views/main.html",controller:"MainCtrl"}).state("state1.list",{url:"/:id",templateUrl:"views/about.html",controller:"AboutCtrl",resolve:{farmerDetail:["csvLib","$stateParams",function(a,b){console.log("Calling farmer ");var c=null,d=document.getElementById("card");return null!==d&&(d.classList.contains("translator")?(d.classList.remove("translatorBack"),d.classList.add("translator")):d.classList.add("translator")),c=a.getFarmerDetail(b.id)}]}}).state("state1.list.info",{url:"/info",templateUrl:"views/info.html",controller:"InfoCtrl"}).state("state1.list.crops",{url:"/crops",templateUrl:"views/crops.html",controller:"CropsCtrl"}).state("state1.list.advices",{url:"/advices",templateUrl:"views/advices.html",controller:"AdvicesCtrl"}).state("state1.list.weather",{url:"/weather",templateUrl:"views/weather.html",controller:"WeatherCtrl"}).state("state1.list.map",{url:"/map",templateUrl:"views/map.html",controller:"MapCtrl"}).state("state2",{url:"/employee/:id1",templateUrl:"views/employee.html",controller:"EmployeeCtrl",resolve:{employeeDetail:["csvLib","$stateParams",function(a,b){return a.getEmployeeDetail(b.id1)}]}}).state("state2.visits",{url:"/visits",templateUrl:"views/einfo.html",controller:"EinfoCtrl"}).state("state2.advices",{url:"/advices",templateUrl:"views/eadvices.html",controller:"EadvicesCtrl",resolve:{adviceDetail:["csvLib","$stateParams",function(a,b){return a.getEmployeeAdvices(b.id1)}]}})}]).run(["Authentication","Application","$rootScope","$location","Routefilter",function(a,b,c,d,e){console.log("Starting"),a.requestUser().then(function(){console.log("After requestUser"),b.makeReady(),d.path("/farmer")},function(){b.makeReady(),d.path("/signin")}),c.$on("$locationChangeStart",function(){"/loading"!==d.path()&&(b.isReady()||d.path("/loading"),e.run(d.path()))})}]),angular.module("dashboardApp").run(["Routefilter","Authentication",function(a,b){a.register("auth",["/farmer","/employee","/changepassword"],function(){return b.exists()},"signin"),a.register("guest",["/signin"],function(){return!b.exists()},"/signin")}]),function(a){var b={ngModel:{primitive:"inputValue"},ngDisabled:{primitive:"disabled"}},c={ngModel:{primitive:"selected"}},d={ngModel:{primitive:"checked"},ngDisabled:{primitive:"disabled"}},e={ngOpened:{primitive:"opened"}},f={ngNarrow:{primitive:"narrow"}},g={coreInput:b,paperInput:b,paperRadioGroup:c,paperTabs:c,paperCheckbox:d,paperToggleButton:d,coreOverlay:e,paperDialog:e,paperToast:e,paperMenuButton:e,coreDrawerPanel:f,coreSelector:c,paperDropdown:c,paperSlider:{ngModel:{primitive:"value"},ngDisabled:{primitive:"disabled"}},coreList:{ngModel:{array:"data"},ngTap:{event:"core-activate"}}},h=window.NG_POLYMER_ELEMENTS_EXTENDED_MAPPINGS;h&&a.extend(g,h);var i=a.module("ng-polymer-elements",[]);Object.keys(g).forEach(function(b){var c=g[b];i.directive(b,["$parse","$window",function(b){var d={},e=Object.keys(c);return e.forEach(function(a){var b=c[a];if(b.primitive||b.object||b.array)d[a]="=";else if(!b.event)throw"Invalid mapping for "+a+" - must contain primitive | object | array | event"}),{restrict:"E",scope:d,link:function(d,f,g){var h=f[0];e.forEach(function(e){if(g[e]){var f=c[e];if(f.event){var i=b(g[e]);h.addEventListener(f.event,function(a){d.$apply(function(){i(d.$parent,{$event:a})})})}else{var j=f.primitive||f.object||f.array;f.object?h[j]={}:f.array&&(h[j]=[]);var k=function(b){f.primitive?h[j]=b:a.copy(b,h[j])};d.$watch(e,k,!0),k(d[e]);var l=new PathObserver(h,j);l.open(function(b){d.$apply(function(){f.primitive?d[e]=b:a.copy(b,d[e])})})}}})}}}])}),document.querySelectorAll("[ng-app]").array().forEach(function(b){function c(){a.bootstrap(wrap(b),[d])}var d=b.getAttribute("ng-app");if(b.removeAttribute("ng-app"),a.isDefined(document.body.attributes.unresolved)){var e=function(){c(),window.removeEventListener("polymer-ready",e)};window.addEventListener("polymer-ready",e)}else c()})}(angular),function(){var a=angular.module("pasvaz.bindonce",[]);a.directive("bindonce",function(){var a=function(a){if(a&&0!==a.length){var b=angular.lowercase(""+a);a=!("f"===b||"0"===b||"false"===b||"no"===b||"n"===b||"[]"===b)}else a=!1;return a},b=parseInt((/msie (\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10);isNaN(b)&&(b=parseInt((/trident\/.*; rv:(\d+)/.exec(angular.lowercase(navigator.userAgent))||[])[1],10));var c={restrict:"AM",controller:["$scope","$element","$attrs","$interpolate",function(c,d,e,f){var g=function(b,c,d){var e="show"===c?"":"none",f="hide"===c?"":"none";b.css("display",a(d)?e:f)},h=function(a,b){if(angular.isObject(b)&&!angular.isArray(b)){var c=[];angular.forEach(b,function(a,b){a&&c.push(b)}),b=c}b&&a.addClass(angular.isArray(b)?b.join(" "):b)},i=function(a,b){a.transclude(b,function(b){var c=a.element.parent(),d=a.element&&a.element[a.element.length-1],e=c&&c[0]||d&&d.parentNode,f=d&&d.nextSibling||null;angular.forEach(b,function(a){e.insertBefore(a,f)})})},j={watcherRemover:void 0,binders:[],group:e.boName,element:d,ran:!1,addBinder:function(a){this.binders.push(a),this.ran&&this.runBinders()},setupWatcher:function(a){var b=this;this.watcherRemover=c.$watch(a,function(a){void 0!==a&&(b.removeWatcher(),b.checkBindonce(a))},!0)},checkBindonce:function(a){var b=this,c=a.$promise?a.$promise.then:a.then;"function"==typeof c?c(function(){b.runBinders()}):b.runBinders()},removeWatcher:function(){void 0!==this.watcherRemover&&(this.watcherRemover(),this.watcherRemover=void 0)},runBinders:function(){for(;this.binders.length>0;){var c=this.binders.shift();if(!this.group||this.group==c.group){var d=c.scope.$eval(c.interpolate?f(c.value):c.value);switch(c.attr){case"boIf":a(d)&&i(c,c.scope.$new());break;case"boSwitch":var e,j=c.controller[0];(e=j.cases["!"+d]||j.cases["?"])&&(c.scope.$eval(c.attrs.change),angular.forEach(e,function(a){i(a,c.scope.$new())}));break;case"boSwitchWhen":var k=c.controller[0];k.cases["!"+c.attrs.boSwitchWhen]=k.cases["!"+c.attrs.boSwitchWhen]||[],k.cases["!"+c.attrs.boSwitchWhen].push({transclude:c.transclude,element:c.element});break;case"boSwitchDefault":var k=c.controller[0];k.cases["?"]=k.cases["?"]||[],k.cases["?"].push({transclude:c.transclude,element:c.element});break;case"hide":case"show":g(c.element,c.attr,d);break;case"class":h(c.element,d);break;case"text":c.element.text(d);break;case"html":c.element.html(d);break;case"style":c.element.css(d);break;case"src":c.element.attr(c.attr,d),b&&c.element.prop("src",d);break;case"attr":angular.forEach(c.attrs,function(a,b){var d,e;b.match(/^boAttr./)&&c.attrs[b]&&(d=b.replace(/^boAttr/,"").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e=c.scope.$eval(c.attrs[b]),c.element.attr(d,e))});break;case"href":case"alt":case"title":case"id":case"value":c.element.attr(c.attr,d)}}}this.ran=!0}};return j}],link:function(a,b,c,d){var e=c.bindonce&&a.$eval(c.bindonce);void 0!==e?d.checkBindonce(e):(d.setupWatcher(c.bindonce),b.bind("$destroy",d.removeWatcher))}};return c}),angular.forEach([{directiveName:"boShow",attribute:"show"},{directiveName:"boHide",attribute:"hide"},{directiveName:"boClass",attribute:"class"},{directiveName:"boText",attribute:"text"},{directiveName:"boBind",attribute:"text"},{directiveName:"boHtml",attribute:"html"},{directiveName:"boSrcI",attribute:"src",interpolate:!0},{directiveName:"boSrc",attribute:"src"},{directiveName:"boHrefI",attribute:"href",interpolate:!0},{directiveName:"boHref",attribute:"href"},{directiveName:"boAlt",attribute:"alt"},{directiveName:"boTitle",attribute:"title"},{directiveName:"boId",attribute:"id"},{directiveName:"boStyle",attribute:"style"},{directiveName:"boValue",attribute:"value"},{directiveName:"boAttr",attribute:"attr"},{directiveName:"boIf",transclude:"element",terminal:!0,priority:1e3},{directiveName:"boSwitch",require:"boSwitch",controller:function(){this.cases={}}},{directiveName:"boSwitchWhen",transclude:"element",priority:800,require:"^boSwitch"},{directiveName:"boSwitchDefault",transclude:"element",priority:800,require:"^boSwitch"}],function(b){var c=200;return a.directive(b.directiveName,function(){var a={priority:b.priority||c,transclude:b.transclude||!1,terminal:b.terminal||!1,require:["^bindonce"].concat(b.require||[]),controller:b.controller,compile:function(a,c,d){return function(a,c,e,f){var g=f[0],h=e.boParent;if(h&&g.group!==h){var i=g.element.parent();g=void 0;for(var j;9!==i[0].nodeType&&i.length;){if((j=i.data("$bindonceController"))&&j.group===h){g=j;break}i=i.parent()}if(!g)throw new Error("No bindonce controller: "+h)}g.addBinder({element:c,attr:b.attribute||b.directiveName,attrs:e,value:e[b.directiveName],interpolate:b.interpolate,group:h,transclude:d,controller:f.slice(1),scope:a})}}};return a})})}(),!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.PouchDB=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b){for(var c=0;c<a.length;c++)if(b(a[c],c)===!0)return a[c];return!1}function d(a){return function(b,c){b||c[0].error?a(b||c[0]):a(null,c[0])}}function e(a){var b={},c=[];return i.traverseRevTree(a,function(a,d,e,f){var g=d+"-"+e;return a&&(b[g]=0),void 0!==f&&c.push({from:f,to:g}),g}),c.reverse(),c.forEach(function(a){b[a.from]=void 0===b[a.from]?1+b[a.to]:Math.min(b[a.from],1+b[a.to])}),b}function f(a,b,c){var d="limit"in b?b.keys.slice(b.skip,b.limit+b.skip):b.skip>0?b.keys.slice(b.skip):b.keys;if(b.descending&&d.reverse(),!d.length)return a._allDocs({limit:0},c);var e={offset:b.skip};return n.all(d.map(function(c){var d=h.extend(!0,{key:c,deleted:"ok"},b);return["limit","skip","keys"].forEach(function(a){delete d[a]}),new n(function(b,f){a._allDocs(d,function(a,d){return a?f(a):(e.total_rows=d.total_rows,void b(d.rows[0]||{key:c,error:"not_found"}))})})})).then(function(a){return e.rows=a,e})}function g(){var a=this;k.call(this),a.autoCompact=function(b){return a.auto_compaction?function(c,d){if(c)b(c);else{var e=d.length,f=function(){e--,e||b(null,d)};d.forEach(function(b){b.ok&&b.id?a.compactDocument(b.id,1,f):f()})}}:b};var b,c=0,d=["change","delete","create","update"];this.on("newListener",function(e){if(~d.indexOf(e)){if(c)return void c++;c++;var f=0;b=this.changes({conflicts:!0,include_docs:!0,continuous:!0,since:"now",onChange:function(b){b.seq<=f||(f=b.seq,a.emit("change",b),b.doc._deleted?a.emit("delete",b):"1"===b.doc._rev.split("-")[0]?a.emit("create",b):a.emit("update",b))}})}}),this.on("removeListener",function(a){~d.indexOf(a)&&(c--,c||b.cancel())})}var h=a("./utils"),i=a("./merge"),j=a("./deps/errors"),k=a("events").EventEmitter,l=a("./deps/upsert"),m=a("./changes"),n=h.Promise;h.inherits(g,k),b.exports=g,g.prototype.post=h.adapterFun("post",function(a,b,c){return"function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a)?c(j.NOT_AN_OBJECT):void this.bulkDocs({docs:[a]},b,this.autoCompact(d(c)))}),g.prototype.put=h.adapterFun("put",h.getArguments(function(a){var b,c,e,f,g=a.shift(),i="_id"in g;if("object"!=typeof g||Array.isArray(g))return(f=a.pop())(j.NOT_AN_OBJECT);for(g=h.clone(g);b=a.shift(),c=typeof b,"string"!==c||i?"string"!==c||!i||"_rev"in g?"object"===c?e=b:"function"===c&&(f=b):g._rev=b:(g._id=b,i=!0),a.length;);e=e||{};var k=h.invalidIdError(g._id);return k?f(k):h.isLocalId(g._id)&&"function"==typeof this._putLocal?g._deleted?this._removeLocal(g,f):this._putLocal(g,f):void this.bulkDocs({docs:[g]},e,this.autoCompact(d(f)))})),g.prototype.putAttachment=h.adapterFun("putAttachment",function(a,b,c,d,e,f){function g(a){return a._attachments=a._attachments||{},a._attachments[b]={content_type:e,data:d},h.put(a)}var h=this;return"function"==typeof e&&(f=e,e=d,d=c,c=null),"undefined"==typeof e&&(e=d,d=c,c=null),h.get(a).then(function(a){if(a._rev!==c)throw j.REV_CONFLICT;return g(a)},function(b){if(b.error===j.MISSING_DOC.error)return g({_id:a});throw b})}),g.prototype.removeAttachment=h.adapterFun("removeAttachment",function(a,b,c,d){var e=this;e.get(a,function(a,f){return a?void d(a):f._rev!==c?void d(j.REV_CONFLICT):f._attachments?(delete f._attachments[b],0===Object.keys(f._attachments).length&&delete f._attachments,void e.put(f,d)):d()})}),g.prototype.remove=h.adapterFun("remove",function(a,b,c,e){var f;"string"==typeof b?(f={_id:a,_rev:b},"function"==typeof c&&(e=c,c={})):(f=a,"function"==typeof b?(e=b,c={}):(e=c,c=b)),c=h.clone(c||{}),c.was_delete=!0;var g={_id:f._id,_rev:f._rev||c.rev};return g._deleted=!0,h.isLocalId(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(f,e):void this.bulkDocs({docs:[g]},c,d(e))}),g.prototype.revsDiff=h.adapterFun("revsDiff",function(a,b,c){function d(a,b){j.has(a)||j.set(a,{missing:[]}),j.get(a).missing.push(b)}function e(b,c){var e=a[b].slice(0);i.traverseRevTree(c,function(a,c,f,g,h){var i=c+"-"+f,j=e.indexOf(i);-1!==j&&(e.splice(j,1),"available"!==h.status&&d(b,i))}),e.forEach(function(a){d(b,a)})}"function"==typeof b&&(c=b,b={}),b=h.clone(b);var f=Object.keys(a);if(!f.length)return c(null,{});var g=0,j=new h.Map;f.map(function(b){this._getRevisionTree(b,function(d,h){if(d&&"not_found"===d.name&&"missing"===d.message)j.set(b,{missing:a[b]});else{if(d)return c(d);e(b,h)}if(++g===f.length){var i={};return j.forEach(function(a,b){i[b]=a}),c(null,i)}})},this)}),g.prototype.compactDocument=function(a,b,c){var d=this;this._getRevisionTree(a,function(f,g){if(f)return c(f);var h=e(g),j=[],k=[];Object.keys(h).forEach(function(a){h[a]>b&&j.push(a)}),i.traverseRevTree(g,function(a,b,c,d,e){var f=b+"-"+c;"available"===e.status&&-1!==j.indexOf(f)&&(e.status="missing",k.push(f))}),d._doCompaction(a,g,k,c)})},g.prototype.compact=h.adapterFun("compact",function(a,b){"function"==typeof a&&(b=a,a={});var c=this;this.changes({complete:function(a,d){if(a)return void b();var e=d.results.length;return e?void d.results.forEach(function(a){c.compactDocument(a.id,0,function(){e--,e||b()})}):void b()}})}),g.prototype.get=h.adapterFun("get",function(a,b,d){function e(){var c=[],e=f.length;return e?void f.forEach(function(f){g.get(a,{rev:f,revs:b.revs,attachments:b.attachments},function(a,b){c.push(a?{missing:f}:{ok:b}),e--,e||d(null,c)})}):d(null,c)}if("function"==typeof b&&(d=b,b={}),"string"!=typeof a)return d(j.INVALID_ID);if(h.isLocalId(a)&&"function"==typeof this._getLocal)return this._getLocal(a,d);var f=[],g=this;if(!b.open_revs)return this._get(a,b,function(a,e){if(b=h.clone(b),a)return d(a);var f=e.doc;if(!f)return d(new Error("no doc!"));var j=e.metadata,k=e.ctx;if(b.conflicts){var l=i.collectConflicts(j);l.length&&(f._conflicts=l)}if(b.revs||b.revs_info){var m=i.rootToLeaf(j.rev_tree),n=c(m,function(a){return-1!==a.ids.map(function(a){return a.id}).indexOf(f._rev.split("-")[1])}),o=n.ids.map(function(a){return a.id}).indexOf(f._rev.split("-")[1])+1,p=n.ids.length-o;if(n.ids.splice(o,p),n.ids.reverse(),b.revs&&(f._revisions={start:n.pos+n.ids.length-1,ids:n.ids.map(function(a){return a.id})}),b.revs_info){var q=n.pos+n.ids.length;f._revs_info=n.ids.map(function(a){return q--,{rev:q+"-"+a.id,status:a.opts.status}})}}if(b.local_seq&&(f._local_seq=e.metadata.seq),b.attachments&&f._attachments){var r=f._attachments,s=Object.keys(r).length;if(0===s)return d(null,f);Object.keys(r).forEach(function(a){this._getAttachment(r[a],{encode:!0,ctx:k},function(b,c){var e=f._attachments[a];e.data=c,delete e.stub,--s||d(null,f)})},g)}else{if(f._attachments)for(var t in f._attachments)f._attachments.hasOwnProperty(t)&&(f._attachments[t].stub=!0);d(null,f)}});if("all"===b.open_revs)this._getRevisionTree(a,function(a,b){a&&(b=[]),f=i.collectLeaves(b).map(function(a){return a.rev}),e()});else{if(!Array.isArray(b.open_revs))return d(j.error(j.UNKNOWN_ERROR,"function_clause"));f=b.open_revs;for(var k=0;k<f.length;k++){var l=f[k];if("string"!=typeof l||!/^\d+-/.test(l))return d(j.error(j.BAD_REQUEST,"Invalid rev format"))}e()}}),g.prototype.getAttachment=h.adapterFun("getAttachment",function(a,b,c,d){var e=this;c instanceof Function&&(d=c,c={}),c=h.clone(c),this._get(a,c,function(a,f){return a?d(a):f.doc._attachments&&f.doc._attachments[b]?(c.ctx=f.ctx,void e._getAttachment(f.doc._attachments[b],c,d)):d(j.MISSING_DOC)})}),g.prototype.allDocs=h.adapterFun("allDocs",function(a,b){if("function"==typeof a&&(b=a,a={}),a=h.clone(a),a.skip="undefined"!=typeof a.skip?a.skip:0,"keys"in a){if(!Array.isArray(a.keys))return b(new TypeError("options.keys must be an array"));var c=["startkey","endkey","key"].filter(function(b){return b in a})[0];if(c)return void b(j.error(j.QUERY_PARSE_ERROR,"Query parameter `"+c+"` is not compatible with multi-get"));if("http"!==this.type())return f(this,a,b)}return this._allDocs(a,b)}),g.prototype.changes=function(a,b){return"function"==typeof a&&(b=a,a={}),new m(this,a,b)},g.prototype.close=h.adapterFun("close",function(a){return this._closed=!0,this._close(a)}),g.prototype.info=h.adapterFun("info",function(a){var b=this;this._info(function(c,d){return c?a(c):(d.db_name=d.db_name||b._db_name,void a(null,d))})}),g.prototype.id=h.adapterFun("id",function(a){return this._id(a)}),g.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},g.prototype.bulkDocs=h.adapterFun("bulkDocs",function(a,b,c){if("function"==typeof b&&(c=b,b={}),b=h.clone(b),Array.isArray(a)&&(a={docs:a}),!a||!a.docs||!Array.isArray(a.docs))return c(j.MISSING_BULK_DOCS);for(var d=0;d<a.docs.length;++d)if("object"!=typeof a.docs[d]||Array.isArray(a.docs[d]))return c(j.NOT_AN_OBJECT);return a=h.clone(a),"new_edits"in b||(b.new_edits="new_edits"in a?a.new_edits:!0),this._bulkDocs(a,b,this.autoCompact(c))}),g.prototype.registerDependentDatabase=h.adapterFun("registerDependentDatabase",function(a,b){function c(b){return b.dependentDbs=b.dependentDbs||{},b.dependentDbs[a]?!1:(b.dependentDbs[a]=!0,b)}var d=new this.constructor(a,{adapter:this._adapter});l(this,"_local/_pouch_dependentDbs",c,function(a){return a?b(a):b(null,{db:d})})})},{"./changes":6,"./deps/errors":11,"./deps/upsert":13,"./merge":18,"./utils":23,events:27}],2:[function(a,b){function c(a){for(var b=c.options,d=b.parser[b.strictMode?"strict":"loose"].exec(a),e={},f=14;f--;)e[b.key[f]]=d[f]||"";return e[b.q.name]={},e[b.key[12]].replace(b.q.parser,function(a,c,d){c&&(e[b.q.name][c]=d)}),e}function d(a){return/^_(design|local)/.test(a)?a:encodeURIComponent(a)}function e(a,b){if(/http(s?):/.test(a)){var d=c(a);d.remote=!0,(d.user||d.password)&&(d.auth={username:d.user,password:d.password});var e=d.path.replace(/(^\/|\/$)/g,"").split("/");if(d.db=e.pop(),d.path=e.join("/"),b=b||{},b=j.clone(b),d.headers=b.headers||{},b.auth||d.auth){var f=b.auth||d.auth,g=j.btoa(f.username+":"+f.password);d.headers.Authorization="Basic "+g}return b.headers&&(d.headers=b.headers),d}return{host:"",path:"/",db:a,auth:!1}}function f(a,b){return g(a,a.db+"/"+b)}function g(a,b){if(a.remote){var c=a.path?"/":"";return a.protocol+"://"+a.host+":"+a.port+"/"+a.path+c+b}return"/"+b}function h(a,b){function c(a,b){return j.ajax(j.extend({},n,a),b)}var h=this;h.getHost=a.getHost?a.getHost:e;var l=h.getHost(a.name,a),m=f(l,"");h.getUrl=function(){return m},h.getHeaders=function(){return j.clone(l.headers)};var n=a.ajax||{};a=j.clone(a);var o=function(){c({headers:l.headers,method:"PUT",url:m},function(a){a&&401===a.status?c({headers:l.headers,method:"HEAD",url:m},function(a){a?b(a):b(null,h)}):a&&412!==a.status?b(a):b(null,h)})};a.skipSetup||c({headers:l.headers,method:"GET",url:m},function(a){a?404===a.status?o():b(a):b(null,h)}),h.type=function(){return"http"},h.id=j.adapterFun("id",function(a){c({headers:l.headers,method:"GET",url:g(l,"")},function(b,c){var d=c&&c.uuid?c.uuid+l.db:f(l,"");a(null,d)})}),h.request=j.adapterFun("request",function(a,b){a.headers=l.headers,a.url=f(l,a.url),c(a,b)}),h.compact=j.adapterFun("compact",function(a,b){"function"==typeof a&&(b=a,a={}),a=j.clone(a),c({headers:l.headers,url:f(l,"_compact"),method:"POST"},function(){function c(){h.info(function(d,e){e.compact_running?setTimeout(c,a.interval||200):b()})}"function"==typeof b&&c()})}),h._info=function(a){c({headers:l.headers,method:"GET",url:f(l,"")},function(b,c){b?a(b):(c.host=f(l,""),a(null,c))})},h.get=j.adapterFun("get",function(a,b,e){"function"==typeof b&&(e=b,b={}),b=j.clone(b),void 0===b.auto_encode&&(b.auto_encode=!0);var g=[];b.revs&&g.push("revs=true"),b.revs_info&&g.push("revs_info=true"),b.local_seq&&g.push("local_seq=true"),b.open_revs&&("all"!==b.open_revs&&(b.open_revs=JSON.stringify(b.open_revs)),g.push("open_revs="+b.open_revs)),b.attachments&&g.push("attachments=true"),b.rev&&g.push("rev="+b.rev),b.conflicts&&g.push("conflicts="+b.conflicts),g=g.join("&"),g=""===g?"":"?"+g,b.auto_encode&&(a=d(a));var h={headers:l.headers,method:"GET",url:f(l,a+g)},i=a.split("/");(i.length>1&&"_design"!==i[0]&&"_local"!==i[0]||i.length>2&&"_design"===i[0]&&"_local"!==i[0])&&(h.binary=!0),c(h,function(a,b,c){return a?e(a):void e(null,b,c)})}),h.remove=j.adapterFun("remove",function(a,b,e,g){var h;"string"==typeof b?(h={_id:a,_rev:b},"function"==typeof e&&(g=e,e={})):(h=a,"function"==typeof b?(g=b,e={}):(g=e,e=b));var i=h._rev||e.rev;c({headers:l.headers,method:"DELETE",url:f(l,d(h._id))+"?rev="+i},g)}),h.getAttachment=j.adapterFun("getAttachment",function(a,b,c,e){"function"==typeof c&&(e=c,c={}),c=j.clone(c),void 0===c.auto_encode&&(c.auto_encode=!0),c.auto_encode&&(a=d(a)),c.auto_encode=!1,h.get(a+"/"+b,c,e)}),h.removeAttachment=j.adapterFun("removeAttachment",function(a,b,e,g){c({headers:l.headers,method:"DELETE",url:f(l,d(a)+"/"+b)+"?rev="+e},g)}),h.putAttachment=j.adapterFun("putAttachment",function(a,b,e,g,h,i){"function"==typeof h&&(i=h,h=g,g=e,e=null),"undefined"==typeof h&&(h=g,g=e,e=null);var k=d(a)+"/"+b,m=f(l,k);e&&(m+="?rev="+e);var n={headers:j.clone(l.headers),method:"PUT",url:m,processData:!1,body:g,timeout:6e4};n.headers["Content-Type"]=h,c(n,i)}),h.put=j.adapterFun("put",j.getArguments(function(a){var b,e,g,h,i=a.shift(),m="_id"in i;if("object"!=typeof i||Array.isArray(i))return(h=a.pop())(k.NOT_AN_OBJECT);for(i=j.clone(i);b=a.shift(),e=typeof b,"string"!==e||m?"string"!==e||!m||"_rev"in i?"object"===e?g=j.clone(b):"function"===e&&(h=b):i._rev=b:(i._id=b,m=!0),a.length;);g=g||{};var n=j.invalidIdError(i._id);if(n)return h(n);var o=[];g&&"undefined"!=typeof g.new_edits&&o.push("new_edits="+g.new_edits),o=o.join("&"),""!==o&&(o="?"+o),c({headers:l.headers,method:"PUT",url:f(l,d(i._id))+o,body:i},function(a,b){return a?h(a):(b.ok=!0,void h(null,b))})})),h.post=j.adapterFun("post",function(a,b,c){return"function"==typeof b&&(c=b,b={}),b=j.clone(b),"object"!=typeof a?c(k.NOT_AN_OBJECT):("_id"in a||(a._id=j.uuid()),void h.put(a,b,function(a,b){return a?c(a):(b.ok=!0,void c(null,b))}))}),h._bulkDocs=function(a,b,d){"undefined"!=typeof b.new_edits&&(a.new_edits=b.new_edits),c({headers:l.headers,method:"POST",url:f(l,"_bulk_docs"),body:a},function(a,b){return a?d(a):(b.forEach(function(a){a.ok=!0}),void d(null,b))})},h.allDocs=j.adapterFun("allDocs",function(a,b){"function"==typeof a&&(b=a,a={}),a=j.clone(a);var d,e=[],g="GET";if(a.conflicts&&e.push("conflicts=true"),a.descending&&e.push("descending=true"),a.include_docs&&e.push("include_docs=true"),a.key&&e.push("key="+encodeURIComponent(JSON.stringify(a.key))),a.startkey&&e.push("startkey="+encodeURIComponent(JSON.stringify(a.startkey))),a.endkey&&e.push("endkey="+encodeURIComponent(JSON.stringify(a.endkey))),"undefined"!=typeof a.inclusive_end&&e.push("inclusive_end="+!!a.inclusive_end),"undefined"!=typeof a.limit&&e.push("limit="+a.limit),"undefined"!=typeof a.skip&&e.push("skip="+a.skip),e=e.join("&"),""!==e&&(e="?"+e),"undefined"!=typeof a.keys){var h=2e3,i="keys="+encodeURIComponent(JSON.stringify(a.keys));i.length+e.length+1<=h?e+=(-1!==e.indexOf("?")?"&":"?")+i:(g="POST",d=JSON.stringify({keys:a.keys}))}c({headers:l.headers,method:g,url:f(l,"_all_docs"+e),body:d},b)}),h._changes=function(a){var b="batch_size"in a?a.batch_size:i;a=j.clone(a),a.timeout=a.timeout||3e4;var d={timeout:a.timeout-5e3},e="undefined"!=typeof a.limit?a.limit:!1;0===e&&(e=1);var g;g="returnDocs"in a?a.returnDocs:!0;var h=e;if(a.style&&(d.style=a.style),(a.include_docs||a.filter&&"function"==typeof a.filter)&&(d.include_docs=!0),a.continuous&&(d.feed="longpoll"),a.conflicts&&(d.conflicts=!0),a.descending&&(d.descending=!0),a.filter&&"string"==typeof a.filter&&(d.filter=a.filter,"_view"===a.filter&&a.view&&"string"==typeof a.view&&(d.view=a.view)),a.query_params&&"object"==typeof a.query_params)for(var m in a.query_params)a.query_params.hasOwnProperty(m)&&(d[m]=a.query_params[m]);var n,o,p=function(g,i){if(!a.aborted){d.since=g,a.descending?e&&(d.limit=h):d.limit=!e||h>b?b:h;var j="?"+Object.keys(d).map(function(a){return a+"="+d[a]}).join("&"),k={headers:l.headers,method:"GET",url:f(l,"_changes"+j),timeout:a.timeout};o=g,a.aborted||(n=c(k,i))}},q=10,r=0,s={results:[]},t=function(c,d){if(!a.aborted){var f=0;if(d&&d.results){f=d.results.length,s.last_seq=d.last_seq;var i={};i.query=a.query_params,d.results=d.results.filter(function(b){h--;var c=j.filterChange(a)(b);return c&&(g&&s.results.push(b),j.call(a.onChange,b)),c})}else if(c)return a.aborted=!0,void j.call(a.complete,c);d&&d.last_seq&&(o=d.last_seq);var l=e&&0>=h||d&&b>f||a.descending;if((!a.continuous||e&&0>=h)&&l)j.call(a.complete,null,s);else{c?r+=1:r=0;var m=1<<r,n=q*m,u=a.maximumWait||3e4;if(n>u)return void j.call(a.complete,c||k.UNKNOWN_ERROR);setTimeout(function(){p(o,t)},n)}}};return p(a.since||0,t),{cancel:function(){a.aborted=!0,n&&n.abort()}}},h.revsDiff=j.adapterFun("revsDiff",function(a,b,d){"function"==typeof b&&(d=b,b={}),c({headers:l.headers,method:"POST",url:f(l,"_revs_diff"),body:JSON.stringify(a)},d)}),h._close=function(a){a()},h.destroy=j.adapterFun("destroy",function(a){c({url:f(l,""),method:"DELETE",headers:l.headers},function(b,c){b?(h.emit("error",b),a(b)):(h.emit("destroyed"),a(null,c))})})}var i=25,j=a("../utils"),k=a("../deps/errors");c.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},h.destroy=j.toPromise(function(a,b,c){var d=e(a,b);b=b||{},"function"==typeof b&&(c=b,b={}),b=j.clone(b),b.headers=d.headers,b.method="DELETE",b.url=f(d,"");var g=b.ajax||{};b=j.extend({},b,g),j.ajax(b,c)}),h.valid=function(){return!0},b.exports=h},{"../deps/errors":11,"../utils":23}],3:[function(a,b){(function(c,d){function e(a,b,c){try{a.apply(b,c)}catch(d){window.PouchDB&&window.PouchDB.emit("error",d)}}function f(){if(!p.running&&p.queue.length){p.running=!0;var a=p.queue.shift();a.action(function(b,d){e(a.callback,this,[b,d]),p.running=!1,c.nextTick(f)})}}function g(a){return function(b){var c=b.target&&b.target.error&&b.target.error.name||b.target;a(n.error(n.IDB_ERROR,c,b.type))}}function h(){var a="_pouch__checkModernIdb_"+(d.navigator&&d.navigator.appVersion),b=l.hasLocalStorage()&&d.localStorage[a];if(b)return JSON.parse(b);var c="_pouch__checkModernIdb",e=null===d.indexedDB.open(c,1).onupgradeneeded;return d.indexedDB.deleteDatabase&&d.indexedDB.deleteDatabase(c),l.hasLocalStorage()&&(d.localStorage[a]=JSON.stringify(e)),e}function i(a,b){var c=this;p.queue.push({action:function(b){j(c,a,b)},callback:b}),f()}function j(a,b,e){function f(a){a.createObjectStore(s,{keyPath:"id"}).createIndex("seq","seq",{unique:!0}),a.createObjectStore(t,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),a.createObjectStore(u,{keyPath:"digest"}),a.createObjectStore(v,{keyPath:"id",autoIncrement:!1}),a.createObjectStore(x)}function h(a,b){var c=a.currentTarget.transaction,d=c.objectStore(s);d.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),d.openCursor().onsuccess=function(a){var e=a.target.result;if(e){var f=e.value,g=l.isDeleted(f);f.deletedOrLocal=g?"1":"0",d.put(f),e["continue"]()}else b(c)}}function j(a){a.createObjectStore(w,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function k(a,b){b=b||a.currentTarget.transaction;var c=b.objectStore(w),e=b.objectStore(s),f=b.objectStore(t),g=e.openCursor();g.onsuccess=function(a){var b=a.target.result;if(b){var g=b.value,h=g.id,i=l.isLocalId(h),j=m.winningRev(g);if(i){var k=h+"::"+j,n=h+"::",o=h+"::~",p=f.index("_doc_id_rev"),q=d.IDBKeyRange.bound(n,o,!1,!1),r=p.openCursor(q);r.onsuccess=function(a){if(r=a.target.result){var d=r.value;d._doc_id_rev===k&&c.put(d),f["delete"](r.primaryKey),r["continue"]()}else e["delete"](b.primaryKey),b["continue"]()}}else b["continue"]()}}}function p(a,b,c){var e="startkey"in b?b.startkey:!1,f="endkey"in b?b.endkey:!1,g="key"in b?b.key:!1,h=b.skip||0,i="number"==typeof b.limit?b.limit:-1,j=b.inclusive_end!==!1,k="descending"in b&&b.descending?"prev":null,o=!1;k&&e&&f&&(o=f,f=!1);var p=null;try{e&&f?p=d.IDBKeyRange.bound(e,f,!1,!j):e?p=k?d.IDBKeyRange.upperBound(e):d.IDBKeyRange.lowerBound(e):f?p=k?d.IDBKeyRange.lowerBound(f,!j):d.IDBKeyRange.upperBound(f,!j):g&&(p=d.IDBKeyRange.only(g))}catch(q){return"DataError"===q.name&&0===q.code?c(null,{total_rows:a,offset:b.skip,rows:[]}):c(n.error(n.IDB_ERROR,q.name,q.message))}var r=C.transaction([s,t],"readonly");r.oncomplete=function(){c(null,{total_rows:a,offset:b.skip,rows:w})};var u=r.objectStore(s),v=k?u.openCursor(p,k):u.openCursor(p),w=[];v.onsuccess=function(a){function c(a,c){var e={id:a.id,key:a.id,value:{rev:f}};if(b.include_docs){e.doc=c,e.doc._rev=f,e.doc._doc_id_rev&&delete e.doc._doc_id_rev,b.conflicts&&(e.doc._conflicts=m.collectConflicts(a));for(var g in e.doc._attachments)e.doc._attachments.hasOwnProperty(g)&&(e.doc._attachments[g].stub=!0)}var k=l.isDeleted(a,f);if("ok"===b.deleted)k&&(e.value.deleted=!0,e.doc=null),w.push(e);else if(!k&&h--<=0){if(o){if(j&&e.key<o)return;if(!j&&e.key<=o)return}if(w.push(e),0===--i)return}d["continue"]()}if(a.target.result){var d=a.target.result,e=d.value,f=e.winningRev||m.winningRev(e);if(b.include_docs){var g=r.objectStore(t).index("_doc_id_rev"),k=e.id+"::"+f;g.get(k).onsuccess=function(a){c(d.value,a.target.result)}}else c(e)}}}function q(a){if(-1!==D)return a(null,D);var b,c=C.transaction([s],"readonly"),e=c.objectStore(s).index("deletedOrLocal");e.count(d.IDBKeyRange.only("0")).onsuccess=function(a){b=a.target.result},c.onerror=g(a),c.oncomplete=function(){D=b,a(null,D)}}var r=3,s="document-store",t="by-sequence",u="attach-store",v="meta-store",w="local-store",x="detect-blob-support",y=b.name,z=null,A=null,B=!1,C=null,D=-1;a.type=function(){return"idb"},a._id=l.toPromise(function(a){a(null,A)}),a._bulkDocs=function(b,c,d){function e(a){var b=a.target.result;b.updateSeq=(b.updateSeq||0)+L,I.objectStore(v).put(b)
}function f(){++M===G.length&&(I.objectStore(v).get(v).onsuccess=e)}function h(){if(G.length){var b=new l.Map;G.forEach(function(c,d){if(c._id&&l.isLocalId(c._id))return void a[c._deleted?"_removeLocal":"_putLocal"](c,{ctx:I},function(a){J[d]=a?a:{},f()});var e=c.metadata.id;b.has(e)?b.get(e).push([c,d]):b.set(e,[[c,d]])}),b.forEach(function(a,b){function c(){f(),++e<a.length&&d()}function d(){var d=a[e],f=d[0],g=d[1];K.has(b)?r(K.get(b),f,g,c):x(f,g,c)}var e=0;d()})}}function j(a){function b(){++c===G.length&&a()}if(!G.length)return a();var c=0;G.forEach(function(a){if(a._id&&l.isLocalId(a._id))return b();var c=a.metadata.id,d=I.objectStore(s).get(c);d.onsuccess=function(a){var d=a.target.result;d&&K.set(c,d),b()}})}function k(){var a=J.map(function(a){if(a._bulk_seq)delete a._bulk_seq;else if(!Object.keys(a).length)return{ok:!0};if(a.error)return a;var b=a.metadata,c=m.winningRev(b);return{ok:!0,id:b.id,rev:c}});i.Changes.notify(y),D=-1,d(null,a)}function o(a,b){if(a.stub)return b();if("string"==typeof a.data){var c;try{c=atob(a.data)}catch(e){var f=n.error(n.BAD_ARG,"Attachments need to be base64 encoded");return d(f)}if(z){var g=a.content_type;c=l.fixBinary(c),a.data=l.createBlob([c],{type:g})}return void l.MD5(c).then(function(c){a.digest="md5-"+c,b()})}var h=new FileReader;h.onloadend=function(){var c=l.arrayBufferToBinaryString(this.result);z||(a.data=btoa(c)),l.MD5(c).then(function(c){a.digest="md5-"+c,b()})},h.readAsArrayBuffer(a.data)}function p(a){function b(){c++,G.length===c&&a()}if(!G.length)return a();var c=0;G.forEach(function(a){function c(){e++,e===d.length&&b()}var d=a.data&&a.data._attachments?Object.keys(a.data._attachments):[];if(!d.length)return b();var e=0;for(var f in a.data._attachments)a.data._attachments.hasOwnProperty(f)&&o(a.data._attachments[f],c)})}function q(a,b,c,d,e){function f(a){i||(a?(i=a,d(i)):j===k.length&&h())}function g(a){j++,f(a)}function h(){function f(f){var g=a.metadata;g.seq=f.target.result,delete g.rev,g.deletedOrLocal=c?"1":"0",g.winningRev=b;var h=I.objectStore(s).put(g);h.onsuccess=function(){delete g.deletedOrLocal,delete g.winningRev,J[e]=a,K.set(a.metadata.id,a.metadata),l.call(d)}}L++,a.data._doc_id_rev=a.data._id+"::"+a.data._rev;var g=I.objectStore(t),h=g.index("_doc_id_rev"),i=g.put(a.data);i.onsuccess=f,i.onerror=function(b){b.preventDefault(),b.stopPropagation();var c=h.getKey(a.data._doc_id_rev);c.onsuccess=function(b){var c=g.put(a.data,b.target.result);L--,c.onsuccess=f}}}var i=null,j=0;a.data._id=a.metadata.id,a.data._rev=a.metadata.rev,c&&(a.data._deleted=!0);var k=a.data._attachments?Object.keys(a.data._attachments):[];for(var m in a.data._attachments)if(a.data._attachments[m].stub)j++,f();else{var n=a.data._attachments[m].data;delete a.data._attachments[m].data;var o=a.data._attachments[m].digest;B(a,o,n,g)}k.length||h()}function r(a,b,c,d){var e=m.merge(a.rev_tree,b.metadata.rev_tree[0],1e3),f=l.isDeleted(a),g=l.isDeleted(b.metadata),h=f&&g&&E||!f&&E&&"new_leaf"!==e.conflicts;if(h)return J[c]=A(n.REV_CONFLICT,b._bulk_seq),d();b.metadata.rev_tree=e.tree;var i=m.winningRev(b.metadata);g=l.isDeleted(b.metadata,i),q(b,i,g,d,c)}function x(a,b,d){var e=m.winningRev(a.metadata),f=l.isDeleted(a.metadata,e);return"was_delete"in c&&f?(J[b]=n.MISSING_DOC,d()):void q(a,e,f,d,b)}function A(a,b){return a._bulk_seq=b,a}function B(a,b,c,d){var e=I.objectStore(u);e.get(b).onsuccess=function(f){var g=f.target.result&&f.target.result.refs||{},h=[a.metadata.id,a.metadata.rev].join("@"),i={digest:b,body:c,refs:g};i.refs[h]=!0,e.put(i).onsuccess=function(){l.call(d)}}}var E=c.new_edits,F=b.docs,G=F.map(function(a,b){if(a._id&&l.isLocalId(a._id))return a;var c=l.parseDoc(a,E);return c._bulk_seq=b,c}),H=G.filter(function(a){return a.error});if(H.length)return d(H[0]);var I,J=new Array(G.length),K=new l.Map,L=0,M=0;p(function(){var a=[s,t,u,v,w];I=C.transaction(a,"readwrite"),I.onerror=g(d),I.ontimeout=g(d),I.oncomplete=k,j(h)})},a._get=function(a,b,c){function d(){c(g,{doc:e,metadata:f,ctx:h})}var e,f,g,h;b=l.clone(b),h=b.ctx?b.ctx:C.transaction([s,t,u],"readonly"),h.objectStore(s).get(a).onsuccess=function(a){if(f=a.target.result,!f)return g=n.MISSING_DOC,d();if(l.isDeleted(f)&&!b.rev)return g=n.error(n.MISSING_DOC,"deleted"),d();var c=h.objectStore(t),i=b.rev||f.winningRev||m.winningRev(f),j=f.id+"::"+i;c.index("_doc_id_rev").get(j).onsuccess=function(a){return e=a.target.result,e&&e._doc_id_rev&&delete e._doc_id_rev,e?void d():(g=n.MISSING_DOC,d())}}},a._getAttachment=function(a,b,c){var d,e;b=l.clone(b),e=b.ctx?b.ctx:C.transaction([s,t,u],"readonly");var f=a.digest,g=a.content_type;e.objectStore(u).get(f).onsuccess=function(a){var e=a.target.result.body;if(b.encode)if(z){var f=new FileReader;f.onloadend=function(){var a=l.arrayBufferToBinaryString(this.result);d=btoa(a),c(null,d)},f.readAsArrayBuffer(e)}else d=e,c(null,d);else z?d=e:(e=l.fixBinary(atob(e)),d=l.createBlob([e],{type:g})),c(null,d)}},a._allDocs=function(a,b){q(function(c,d){return c?b(c):0===a.limit?b(null,{total_rows:d,offset:a.skip,rows:[]}):void p(d,a,b)})},a._info=function(a){q(function(b,c){if(b)return a(b);if(null===C){var d=new Error("db isn't open");return d.id="idbNull",a(d)}var e=0,f=C.transaction([v],"readonly");f.objectStore(v).get(v).onsuccess=function(a){e=a.target.result&&a.target.result.updateSeq||0},f.oncomplete=function(){a(null,{doc_count:c,update_seq:e})}})},a._changes=function(b){function c(){o=C.transaction([s,t],"readonly"),o.oncomplete=f;var a;a=h?o.objectStore(t).openCursor(d.IDBKeyRange.lowerBound(b.since,!0),h):o.objectStore(t).openCursor(d.IDBKeyRange.lowerBound(b.since,!0)),a.onsuccess=e,a.onerror=onerror}function e(a){var c=a.target.result;if(c){var d=c.value;if(b.doc_ids&&-1===b.doc_ids.indexOf(d._id))return c["continue"]();var e=o.objectStore(s);e.get(d._id).onsuccess=function(a){var e=a.target.result;j<e.seq&&(j=e.seq);var f=e.winningRev||m.winningRev(e);if(d._rev!==f)return c["continue"]();delete d._doc_id_rev;var g=b.processChange(d,e,b);g.seq=c.key,r(g)&&(q++,n&&p.push(g),b.onChange(g)),q!==k&&c["continue"]()}}}function f(){b.continuous||b.complete(null,{results:p,last_seq:j})}if(b=l.clone(b),b.continuous){var g=y+":"+l.uuid();return i.Changes.addListener(y,g,a,b),i.Changes.notify(y),{cancel:function(){i.Changes.removeListener(y,g)}}}var h=b.descending?"prev":null,j=0;b.since=b.since&&!h?b.since:0;var k="limit"in b?b.limit:-1;0===k&&(k=1);var n;n="returnDocs"in b?b.returnDocs:!0;var o,p=[],q=0,r=l.filterChange(b);c()},a._close=function(a){return null===C?a(n.NOT_OPEN):(C.close(),delete o[y],C=null,void a())},a._getRevisionTree=function(a,b){var c=C.transaction([s],"readonly"),d=c.objectStore(s).get(a);d.onsuccess=function(a){var c=a.target.result;c?b(null,c.rev_tree):b(n.MISSING_DOC)}},a._doCompaction=function(a,b,c,d){var e=C.transaction([s,t],"readwrite"),f=e.objectStore(s);f.get(a).onsuccess=function(d){var f=d.target.result;f.rev_tree=b;var g=c.length;c.forEach(function(b){var c=e.objectStore(t).index("_doc_id_rev"),d=a+"::"+b;c.getKey(d).onsuccess=function(a){var b=a.target.result;b&&(e.objectStore(t)["delete"](b),g--,g||e.objectStore(s).put(f))}})},e.oncomplete=function(){l.call(d)}},a._getLocal=function(a,b){var c=C.transaction([w],"readonly"),d=c.objectStore(w).get(a);d.onerror=g(b),d.onsuccess=function(a){var c=a.target.result;c?(delete c._doc_id_rev,b(null,c)):b(n.MISSING_DOC)}},a._putLocal=function(a,b,c){"function"==typeof b&&(c=b,b={});var d=a._rev,e=a._id;a._rev=d?"0-"+(parseInt(d.split("-")[1],10)+1):"0-0",a._doc_id_rev=e+"::"+a._rev;var f,h=b.ctx;h||(h=C.transaction([w],"readwrite"),h.onerror=g(c),h.oncomplete=function(){f&&c(null,f)});var i,j=h.objectStore(w);if(d){var k=j.index("_doc_id_rev"),l=e+"::"+d;i=k.get(l),i.onsuccess=function(d){if(d.target.result){var e=j.put(a);e.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)}}else c(n.REV_CONFLICT)}}else i=j.get(e),i.onsuccess=function(d){if(d.target.result)c(n.REV_CONFLICT);else{var e=j.put(a);e.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)}}}},a._removeLocal=function(a,b){var c,d=C.transaction([w],"readwrite");d.oncomplete=function(){c&&b(null,c)};var e=a._id+"::"+a._rev,f=d.objectStore(w),h=f.index("_doc_id_rev"),i=h.get(e);i.onerror=g(b),i.onsuccess=function(a){var d=a.target.result;if(d){var g=h.getKey(e);g.onsuccess=function(a){var b=a.target.result;f["delete"](b),c={ok:!0,id:d._id,rev:"0-0"}}}else b(n.MISSING_DOC)}};var E=o[y];if(E)return C=E.idb,z=E.blobSupport,A=E.instanceId,B=E.idStored,void c.nextTick(function(){e(null,a)});var F=d.indexedDB.open(y,r);"openReqList"in i||(i.openReqList={}),i.openReqList[y]=F,F.onupgradeneeded=function(a){var b=a.target.result;a.oldVersion<1&&f(b),a.oldVersion<3&&(j(b),a.oldVersion<2?h(a,function(b){k(a,b)}):k(a))},F.onsuccess=function(b){C=b.target.result,C.onversionchange=function(){C.close(),delete o[y]},C.onabort=function(){C.close(),delete o[y]};var c=C.transaction([v,x],"readwrite"),d=c.objectStore(v).get(v);d.onsuccess=function(b){var d=function(){null!==z&&B&&(o[y]={idb:C,blobSupport:z,instanceId:A,idStored:B,loaded:!0},e(null,a))},f=b.target.result||{id:v};y+"_id"in f?(A=f[y+"_id"],B=!0,d()):(A=l.uuid(),f[y+"_id"]=A,c.objectStore(v).put(f).onsuccess=function(){B=!0,d()});try{c.objectStore(x).put(l.createBlob(),"key"),z=!0}catch(g){z=!1}finally{d()}}},F.onerror=g(e)}function k(a,b,c){"openReqList"in i||(i.openReqList={}),i.Changes.removeAllListeners(a),i.openReqList[a]&&i.openReqList[a].result&&i.openReqList[a].result.close();var e=d.indexedDB.deleteDatabase(a);e.onsuccess=function(){i.openReqList[a]&&(i.openReqList[a]=null),l.hasLocalStorage()&&a in d.localStorage&&delete d.localStorage[a],delete o[a],c(null,{ok:!0})},e.onerror=g(c)}var l=a("../utils"),m=a("../merge"),n=a("../deps/errors"),o={},p={running:!1,queue:[]};i.valid=function(){return d.indexedDB&&h()},i.destroy=l.toPromise(function(a,b,c){p.queue.push({action:function(c){k(a,b,c)},callback:c}),f()}),i.Changes=new l.Changes,b.exports=i}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../deps/errors":11,"../merge":18,"../utils":23,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28}],4:[function(a,b){b.exports=["idb","websql"]},{}],5:[function(a,b){(function(c){function d(a){return"'"+a+"'"}function e(a,b,c,d,e){return"SELECT "+a+" FROM "+("string"==typeof b?b:b.join(" JOIN "))+(c?" ON "+c:"")+(d?" WHERE "+("string"==typeof d?d:d.join(" AND ")):"")+(e?" ORDER BY "+e:"")}function f(a){return function(b){var c=b&&b.constructor.toString().match(/function ([^\(]+)/),d=c&&c[1]||b.type,e=b.target||b.message;a(o.error(o.WSQ_ERROR,e,d))}}function g(a){return decodeURIComponent(window.escape(a))}function h(a,b){for(var c="",d="UTF-8"===b?2:4,e=0,f=a.length;f>e;e+=d){var h=a.substring(e,e+d);4===d&&(h=h.substring(2,4)+h.substring(0,2)),c+=String.fromCharCode(parseInt(h,16))}return c="UTF-8"===b?g(c):c}function i(a){return delete a._id,delete a._rev,JSON.stringify(a)}function j(a,b,c){return a=JSON.parse(a),a._id=b,a._rev=c,a}function k(a){if("size"in a)return 1e6*a.size;var b=/Android/.test(window.navigator.userAgent);return b?5e6:1}function l(a,b){function d(){m.hasLocalStorage()&&(c.localStorage["_pouch__websqldb_"+M]=!0),b(null,K)}function g(a,b){a.executeSql(A),a.executeSql("ALTER TABLE "+u+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){a.executeSql(y),a.executeSql("ALTER TABLE "+t+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){a.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+t+" (local, id)");var c="SELECT "+t+".winningseq AS seq, "+t+".json AS metadata FROM "+u+" JOIN "+t+" ON "+u+".seq = "+t+".winningseq";a.executeSql(c,[],function(a,c){for(var d=[],e=[],f=0;f<c.rows.length;f++){var g=c.rows.item(f),h=g.seq,i=JSON.parse(g.metadata);m.isDeleted(i)&&d.push(h),m.isLocalId(i.id)&&e.push(i.id)}a.executeSql("UPDATE "+t+"SET local = 1 WHERE id IN ("+e.map(function(){return"?"}).join(",")+")",e,function(){a.executeSql("UPDATE "+u+" SET deleted = 1 WHERE seq IN ("+d.map(function(){return"?"}).join(",")+")",d,b)})})})})}function p(a,b){var c="CREATE TABLE IF NOT EXISTS "+w+" (id UNIQUE, rev, json)";a.executeSql(c,[],function(){var c="SELECT "+t+".id AS id, "+u+".json AS data FROM "+u+" JOIN "+t+" ON "+u+".seq = "+t+".winningseq WHERE local = 1";a.executeSql(c,[],function(a,c){function d(){if(!e.length)return b();var c=e.shift(),f=JSON.parse(c.data)._rev;a.executeSql("INSERT INTO "+w+" (id, rev, json) VALUES (?,?,?)",[c.id,f,c.data],function(a){a.executeSql("DELETE FROM "+t+" WHERE id=?",[c.id],function(a){a.executeSql("DELETE FROM "+u+" WHERE seq=?",[c.seq],function(){d()})})})}for(var e=[],f=0;f<c.rows.length;f++)e.push(c.rows.item(f));d()})})}function D(a,b){function c(c,d){function e(){if(!c.length)return b();var f=c.shift(),g=h(f.hex,d),i=g.lastIndexOf("::"),j=g.substring(0,i),k=g.substring(i+2),l="UPDATE "+u+" SET doc_id=?, rev=? WHERE doc_id_rev=?";a.executeSql(l,[j,k,g],function(){e()})}e()}var d="ALTER TABLE "+u+" ADD COLUMN doc_id";a.executeSql(d,[],function(a){var b="ALTER TABLE "+u+" ADD COLUMN rev";a.executeSql(b,[],function(a){a.executeSql(z,[],function(a){var b="SELECT hex(doc_id_rev) as hex FROM "+u;a.executeSql(b,[],function(a,b){for(var d=[],e=0;e<b.rows.length;e++)d.push(b.rows.item(e));a.executeSql("SELECT dbid, hex(dbid) AS hexId FROM "+x,[],function(a,b){var e=b.rows.item(0).dbid,f=b.rows.item(0).hexId,g=f.length===2*e.length?"UTF-8":"UTF-16";c(d,g)})})})})})}function E(a){for(;O.length>0;){var b=O.pop();b(null,L)}F(a)}function F(a){a.executeSql("SELECT dbid, hex(dbid) AS hexId FROM "+x,[],function(a,b){var c=b.rows.item(0).dbid,d=b.rows.item(0).hexId;J=d.length===2*c.length?"UTF-8":"UTF-16"})}function G(a,b){if(0===b){var c="CREATE TABLE IF NOT EXISTS "+x+" (update_seq INTEGER, dbid, db_version INTEGER)",d="CREATE TABLE IF NOT EXISTS "+v+" (digest, json, body BLOB)",e="CREATE TABLE IF NOT EXISTS "+t+" (id unique, json, winningseq)",f="CREATE TABLE IF NOT EXISTS "+u+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",h="CREATE TABLE IF NOT EXISTS "+w+" (id UNIQUE, rev, json)";a.executeSql(d),a.executeSql(h),a.executeSql(e,[],function(){a.executeSql(A),a.executeSql(f,[],function(){a.executeSql(y),a.executeSql(z),a.executeSql(c,[],function(){var b="INSERT INTO "+x+" (update_seq, db_version, dbid) VALUES (?, ?, ?)";L=m.uuid();var c=[0,s,L];a.executeSql(b,c,function(a){E(a)})})})})}else{var i=function(){var c=s>b;c&&a.executeSql("UPDATE "+x+" SET db_version = "+s);var d="SELECT dbid FROM "+x;a.executeSql(d,[],function(a,b){L=b.rows.item(0).dbid,E(a)})};switch(b){case 1:g(a,function(){p(a,function(){D(a,i)})});break;case 2:p(a,function(){D(a,i)});break;case 3:D(a,i);break;default:i()}}}function H(){Q.transaction(function(a){a.executeSql("SELECT sql FROM sqlite_master WHERE tbl_name = "+x,[],function(a,b){b.rows.length?/db_version/.test(b.rows.item(0).sql)?a.executeSql("SELECT db_version FROM "+x,[],function(a,b){var c=b.rows.item(0).db_version;G(a,c)}):a.executeSql("ALTER TABLE "+x+" ADD COLUMN db_version INTEGER",[],function(){G(a,1)}):G(a,0)})},f(b),d)}function I(a,b){if(-1!==P)return b(P);var c=e("COUNT("+t+".id) AS 'num'",[t,u],B,u+".deleted=0");a.executeSql(c,[],function(a,c){P=c.rows.item(0).num,b(P)})}var J,K=this,L=null,M=a.name,N=k(a),O=[],P=-1,Q=q(M,r,M,N);return Q?("function"!=typeof Q.readTransaction&&(Q.readTransaction=Q.transaction),m.isCordova()&&"undefined"!=typeof c?c.addEventListener(M+"_pouch",function R(){c.removeEventListener(M+"_pouch",R,!1),H()},!1):H(),K.type=function(){return"websql"},K._id=m.toPromise(function(a){a(null,L)}),K._info=function(a){Q.readTransaction(function(b){I(b,function(c){var d="SELECT update_seq FROM "+x;b.executeSql(d,[],function(b,d){var e=d.rows.item(0).update_seq;a(null,{doc_count:c,update_seq:e})})})},f(a))},K._bulkDocs=function(a,b,c){function d(){var a=E.map(function(a){if(a._bulk_seq)delete a._bulk_seq;else if(!Object.keys(a).length)return{ok:!0};if(a.error)return a;var b=a.metadata,c=n.winningRev(b);return{ok:!0,id:b.id,rev:c}});l.Changes.notify(M);var b="SELECT update_seq FROM "+x;D.executeSql(b,[],function(b,d){var e=d.rows.item(0).update_seq+F,f="UPDATE "+x+" SET update_seq=?";b.executeSql(f,[e],function(){c(null,a)})})}function g(a,b){if(a.stub)return b();if("string"==typeof a.data){try{a.data=atob(a.data)}catch(d){var e=o.error(o.BAD_ARG,"Attachments need to be base64 encoded");return c(e)}var f=m.fixBinary(a.data);a.data=m.createBlob([f],{type:a.content_type})}var g=new FileReader;g.onloadend=function(){var c=m.arrayBufferToBinaryString(this.result);a.data=c,m.MD5(c).then(function(c){a.digest="md5-"+c,b()})},g.readAsArrayBuffer(a.data)}function h(a){function b(){c++,B.length===c&&a()}if(!B.length)return a();var c=0;B.forEach(function(a){function c(){e++,e===d.length&&b()}var d=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],e=0;if(!d.length)return b();for(var f in a.data._attachments)a.data._attachments.hasOwnProperty(f)&&g(a.data._attachments[f],c)})}function j(a,b,c,d,f,g){function h(){F++;var b=a.data,d=c?1:0,f=b._id,g=b._rev,h=i(b),j="INSERT INTO "+u+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",k=[f,g,h,d];D.executeSql(j,k,function(a,b){l(a,b.insertId)},function(){var a=e("seq",u,null,"doc_id=? AND rev=?");return D.executeSql(a,[f,g],function(a,b){var c=b.rows.item(0).seq,e="UPDATE "+u+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",i=[h,d,f,g];a.executeSql(e,i,function(a){F--,l(a,c)})}),!1})}function j(a){m||(a?(m=a,d(m)):n===o.length&&h())}function k(a){n++,j(a)}function l(c,e){a.metadata.seq=e,delete a.metadata.rev;var h=f?"UPDATE "+t+" SET json=?, winningseq=(SELECT seq FROM "+u+" WHERE doc_id="+t+".id AND rev=?) WHERE id=?":"INSERT INTO "+t+" (id, winningseq, json) VALUES (?, ?, ?);",i=JSON.stringify(a.metadata),j=a.metadata.id,k=f?[i,b,j]:[j,e,i];c.executeSql(h,k,function(){E[g]=a,G.set(j,a.metadata),d()})}var m=null,n=0;a.data._id=a.metadata.id,a.data._rev=a.metadata.rev,c&&(a.data._deleted=!0);var o=a.data._attachments?Object.keys(a.data._attachments):[];for(var p in a.data._attachments)if(a.data._attachments[p].stub)n++,j();else{var q=a.data._attachments[p].data;delete a.data._attachments[p].data;var r=a.data._attachments[p].digest;y(a,r,q,k)}o.length||h()}function k(a,b,c,d){var e=n.merge(a.rev_tree,b.metadata.rev_tree[0],1e3),f=m.isDeleted(b.metadata),g=m.isDeleted(a),h=g&&f&&z||!g&&z&&"new_leaf"!==e.conflicts;if(h)return E[c]=w(o.REV_CONFLICT,b._bulk_seq),d();b.metadata.rev_tree=e.tree;var i=n.winningRev(b.metadata);f=m.isDeleted(b.metadata,i),j(b,i,f,d,!0,c)}function p(a,c,d){var e=n.winningRev(a.metadata),f=m.isDeleted(a.metadata,e);return"was_delete"in b&&f?(E[c]=o.MISSING_DOC,d()):void j(a,e,f,d,!1,c)}function q(){++H===B.length&&d()}function r(){if(!B.length)return d();var a=new m.Map;B.forEach(function(b,c){if(b._id&&m.isLocalId(b._id))return void K[b._deleted?"_removeLocal":"_putLocal"](b,{ctx:D},function(a){E[c]=a?a:{},q()});var d=b.metadata.id;a.has(d)?a.get(d).push([b,c]):a.set(d,[[b,c]])}),a.forEach(function(a,b){function c(){q(),++e<a.length&&d()}function d(){var d=a[e],f=d[0],g=d[1];G.has(b)?k(G.get(b),f,g,c):p(f,g,c)}var e=0;d()})}function s(a){function b(){++c===B.length&&a()}if(!B.length)return a();var c=0;B.forEach(function(a){if(a._id&&m.isLocalId(a._id))return b();var c=a.metadata.id;D.executeSql("SELECT json FROM "+t+" WHERE id = ?",[c],function(a,d){if(d.rows.length){var e=JSON.parse(d.rows.item(0).json);G.set(c,e)}b()})})}function w(a,b){return a._bulk_seq=b,a}function y(a,b,c,d){var e=[a.metadata.id,a.metadata.rev].join("@"),f={digest:b},g="SELECT digest, json FROM "+v+" WHERE digest=?";D.executeSql(g,[b],function(a,h){h.rows.length?(f.refs=JSON.parse(h.rows.item(0).json).refs,g="UPDATE "+v+" SET json=?, body=? WHERE digest=?",a.executeSql(g,[JSON.stringify(f),c,b],function(){d()})):(f.refs={},f.refs[e]=!0,g="INSERT INTO "+v+"(digest, json, body) VALUES (?, ?, ?)",a.executeSql(g,[b,JSON.stringify(f),c],function(){d()}))})}var z=b.new_edits,A=a.docs,B=A.map(function(a,b){if(a._id&&m.isLocalId(a._id))return a;var c=m.parseDoc(a,z);return c._bulk_seq=b,c}),C=B.filter(function(a){return a.error});if(C.length)return c(C[0]);var D,E=new Array(B.length),F=0,G=new m.Map,H=0;h(function(){Q.transaction(function(a){D=a,s(r)},f(c),function(){P=-1})})},K._get=function(a,b,c){function d(){c(h,{doc:f,metadata:g,ctx:l})}b=m.clone(b);var f,g,h;if(!b.ctx)return void Q.readTransaction(function(d){b.ctx=d,K._get(a,b,c)});var i,k,l=b.ctx;b.rev?(i=e(C,[t,u],t+".id="+u+".doc_id",[u+".doc_id=?",u+".rev=?"]),k=[a,b.rev]):(i=e(C,[t,u],B,t+".id=?"),k=[a]),l.executeSql(i,k,function(a,c){if(!c.rows.length)return h=o.MISSING_DOC,d();var e=c.rows.item(0);return g=JSON.parse(e.metadata),e.deleted&&!b.rev?(h=o.error(o.MISSING_DOC,"deleted"),d()):(f=j(e.data,g.id,e.rev),void d())})},K._allDocs=function(a,b){var c,d=[],g="startkey"in a?a.startkey:!1,h="endkey"in a?a.endkey:!1,i="key"in a?a.key:!1,k="descending"in a?a.descending:!1,l="limit"in a?a.limit:-1,m="skip"in a?a.skip:0,o=a.inclusive_end!==!1,p=[],q=[];if(i!==!1)q.push(t+".id = ?"),p.push(i);else if(g!==!1||h!==!1){if(g!==!1&&(q.push(t+".id "+(k?"<=":">=")+" ?"),p.push(g)),h!==!1){var r=k?">":"<";o&&(r+="="),q.push(t+".id "+r+" ?"),p.push(h)}i!==!1&&(q.push(t+".id = ?"),p.push(i))}"ok"!==a.deleted&&q.push(u+".deleted = 0"),Q.readTransaction(function(b){I(b,function(f){if(c=f,0!==l){var g=e(C,[t,u],B,q,t+".id "+(k?"DESC":"ASC"));g+=" LIMIT "+l+" OFFSET "+m,b.executeSql(g,p,function(b,c){for(var e=0,f=c.rows.length;f>e;e++){var g=c.rows.item(e),h=JSON.parse(g.metadata),i=j(g.data,h.id,g.rev),k=i._rev,l={id:h.id,key:h.id,value:{rev:k}};if(a.include_docs){l.doc=i,l.doc._rev=k,a.conflicts&&(l.doc._conflicts=n.collectConflicts(h));for(var m in l.doc._attachments)l.doc._attachments.hasOwnProperty(m)&&(l.doc._attachments[m].stub=!0)}if(g.deleted){if("ok"!==a.deleted)continue;l.value.deleted=!0,l.doc=null}d.push(l)}})}})},f(b),function(){b(null,{total_rows:c,offset:a.skip,rows:d})})},K._changes=function(a){function b(){var b=[t+".winningseq > "+a.since],c=[];a.doc_ids&&(b.push(t+".id IN ("+a.doc_ids.map(function(){return"?"}).join(",")+")"),c=a.doc_ids);var k=e(C,[t,u],B,b,t+".winningseq "+(d?"DESC":"ASC")),l=m.filterChange(a);a.view||a.filter||(k+=" LIMIT "+f),Q.readTransaction(function(b){b.executeSql(k,c,function(b,c){for(var d=0,e=0,k=c.rows.length;k>e;e++){var m=c.rows.item(e),n=JSON.parse(m.metadata);d<m.seq&&(d=m.seq);var o=j(m.data,n.id,m.rev),p=a.processChange(o,n,a);if(p.seq=m.seq,l(p)&&(i++,g&&h.push(p),a.onChange(p)),i===f)break}a.continuous||a.complete(null,{results:h,last_seq:d})})})}if(a=m.clone(a),a.continuous){var c=M+":"+m.uuid();return l.Changes.addListener(M,c,K,a),l.Changes.notify(M),{cancel:function(){l.Changes.removeListener(M,c)}}}var d=a.descending;a.since=a.since&&!d?a.since:0;var f="limit"in a?a.limit:-1;0===f&&(f=1);var g;g="returnDocs"in a?a.returnDocs:!0;var h=[],i=0;b()},K._close=function(a){a()},K._getAttachment=function(a,b,c){var d,e=b.ctx,f=a.digest,g=a.content_type,i="SELECT hex(body) as body FROM "+v+" WHERE digest=?";e.executeSql(i,[f],function(a,e){var f=h(e.rows.item(0).body,J);b.encode?d=btoa(f):(f=m.fixBinary(f),d=m.createBlob([f],{type:g})),c(null,d)})},K._getRevisionTree=function(a,b){Q.readTransaction(function(c){var d="SELECT json AS metadata FROM "+t+" WHERE id = ?";c.executeSql(d,[a],function(a,c){if(c.rows.length){var d=JSON.parse(c.rows.item(0).metadata);b(null,d.rev_tree)}else b(o.MISSING_DOC)})})},K._doCompaction=function(a,b,c,d){return c.length?void Q.transaction(function(e){var f="SELECT json AS metadata FROM "+t+" WHERE id = ?";e.executeSql(f,[a],function(e,f){if(!f.rows.length)return m.call(d);var g=JSON.parse(f.rows.item(0).metadata);g.rev_tree=b;var h=0;c.forEach(function(b){var f="DELETE FROM "+u+" WHERE doc_id=? AND rev=?";e.executeSql(f,[a,b],function(b){if(++h===c.length){var e="UPDATE "+t+" SET json = ? WHERE id = ?";b.executeSql(e,[JSON.stringify(g),a],function(){d()})}})})})}):d()},K._getLocal=function(a,b){Q.readTransaction(function(c){var d="SELECT json, rev FROM "+w+" WHERE id=?";c.executeSql(d,[a],function(c,d){if(d.rows.length){var e=d.rows.item(0),f=j(e.json,a,e.rev);b(null,f)}else b(o.MISSING_DOC)})})},K._putLocal=function(a,b,c){function d(a){var d,f;g?(d="UPDATE "+w+" SET rev=?, json=? WHERE id=? AND rev=?",f=[e,k,h,g]):(d="INSERT INTO "+w+" (id, rev, json) VALUES (?,?,?)",f=[h,e,k]),a.executeSql(d,f,function(a,d){d.rowsAffected?(j={ok:!0,id:h,rev:e},b.ctx&&c(null,j)):c(o.REV_CONFLICT)},function(){return c(o.REV_CONFLICT),!1})}"function"==typeof b&&(c=b,b={});var e,g=a._rev,h=a._id;e=a._rev=g?"0-"+(parseInt(g.split("-")[1],10)+1):"0-0";var j,k=i(a);b.ctx?d(b.ctx):Q.transaction(function(a){d(a)},f(c),function(){j&&c(null,j)})},void(K._removeLocal=function(a,b){var c;Q.transaction(function(d){var e="DELETE FROM "+w+" WHERE id=? AND rev=?",f=[a._id,a._rev];d.executeSql(e,f,function(d,e){return e.rowsAffected?void(c={ok:!0,id:a._id,rev:"0-0"}):b(o.REV_CONFLICT)})},f(b),function(){b(null,c)})})):b(o.UNKNOWN_ERROR)}var m=a("../utils"),n=a("../merge"),o=a("../deps/errors"),p={},q=m.getArguments(function(a){if("undefined"!=typeof c){if(c.navigator&&c.navigator.sqlitePlugin&&c.navigator.sqlitePlugin.openDatabase)return navigator.sqlitePlugin.openDatabase.apply(navigator.sqlitePlugin,a);if(c.sqlitePlugin&&c.sqlitePlugin.openDatabase)return c.sqlitePlugin.openDatabase.apply(c.sqlitePlugin,a);var b=p[a[0]];return b||(b=p[a[0]]=c.openDatabase.apply(c,a)),b}}),r=1,s=4,t=d("document-store"),u=d("by-sequence"),v=d("attach-store"),w=d("local-store"),x=d("metadata-store"),y="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+u+" (seq, deleted)",z="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+u+" (doc_id, rev)",A="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+t+" (winningseq)",B=u+".seq = "+t+".winningseq",C=u+".seq AS seq, "+u+".deleted AS deleted, "+u+".json AS data, "+u+".rev AS rev, "+t+".json AS metadata";l.valid=function(){if("undefined"!=typeof c){if(c.navigator&&c.navigator.sqlitePlugin&&c.navigator.sqlitePlugin.openDatabase)return!0;if(c.sqlitePlugin&&c.sqlitePlugin.openDatabase)return!0;if(c.openDatabase)return!0}return!1},l.destroy=m.toPromise(function(a,b,d){l.Changes.removeAllListeners(a);var e=k(b),g=q(a,r,a,e);g.transaction(function(a){var b=[t,u,v,x,w];b.forEach(function(b){a.executeSql("DROP TABLE IF EXISTS "+b,[])})},f(d),function(){m.hasLocalStorage()&&(delete c.localStorage["_pouch__websqldb_"+a],delete c.localStorage[a]),d(null,{ok:!0})})}),l.Changes=new m.Changes,b.exports=l}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../deps/errors":11,"../merge":18,"../utils":23}],6:[function(a,b){function c(a,b,c){function d(){f.cancel()}h.call(this);var f=this;this.db=a,b=b?e.clone(b):{};var g=c||b.complete||function(){},i=b.complete=e.once(function(b,c){b?f.emit("error",b):f.emit("complete",c),f.removeAllListeners(),a.removeListener("destroyed",d)});g&&(f.on("complete",function(a){g(null,a)}),f.on("error",function(a){g(a)}));var j=b.onChange;j&&f.on("change",j),a.once("destroyed",d),b.onChange=function(a){b.isCancelled||(f.emit("change",a),f.startSeq&&f.startSeq<=a.seq&&(f.emit("uptodate"),f.startSeq=!1),a.deleted?f.emit("delete",a):1===a.changes.length&&"1-"===a.changes[0].rev.slice(0,2)?f.emit("create",a):f.emit("update",a))};var k=new e.Promise(function(a,c){b.complete=function(b,d){b?c(b):a(d)}});f.once("cancel",function(){j&&f.removeListener("change",j),b.complete(null,{status:"cancelled"})}),this.then=k.then.bind(k),this["catch"]=k["catch"].bind(k),this.then(function(a){i(null,a)},i),a.taskqueue.isReady?f.doChanges(b):a.taskqueue.addTask(function(){f.isCancelled?f.emit("cancel"):f.doChanges(b)})}function d(a,b,c){var d=[{rev:a._rev}];"all_docs"===c.style&&(d=f.collectLeaves(b.rev_tree).map(function(a){return{rev:a.rev}}));var g={id:b.id,changes:d,doc:a};return e.isDeleted(b,a._rev)&&(g.deleted=!0),c.conflicts&&(g.doc._conflicts=f.collectConflicts(b),g.doc._conflicts.length||delete g.doc._conflicts),g}var e=a("./utils"),f=a("./merge"),g=a("./deps/errors"),h=a("events").EventEmitter,i=a("./evalFilter"),j=a("./evalView");b.exports=c,e.inherits(c,h),c.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},c.prototype.doChanges=function(a){var b=this,c=a.complete;if(a=e.clone(a),"live"in a&&!("continuous"in a)&&(a.continuous=a.live),a.processChange=d,"latest"===a.since&&(a.since="now"),a.since||(a.since=0),"now"===a.since)return void this.db.info().then(function(d){return b.isCancelled?void c(null,{status:"cancelled"}):(a.since=d.update_seq-1,void b.doChanges(a))},c);if(a.continuous&&"now"!==a.since&&this.db.info().then(function(a){b.startSeq=a.update_seq-1},function(a){if("idbNull"!==a.id)throw a}),"http"!==this.db.type()&&a.filter&&"string"==typeof a.filter)return this.filterChanges(a);"descending"in a||(a.descending=!1),a.limit=0===a.limit?1:a.limit,a.complete=c;var f=this.db._changes(a);if(f&&"function"==typeof f.cancel){var g=b.cancel;b.cancel=e.getArguments(function(a){f.cancel(),g.apply(this,a)})}},c.prototype.filterChanges=function(a){var b=this,c=a.complete;if("_view"===a.filter){if(!a.view||"string"!=typeof a.view){var d=new Error("`view` filter parameter is not provided.");return d.status=g.BAD_REQUEST.status,d.name=g.BAD_REQUEST.name,d.error=!0,void c(d)}var e=a.view.split("/");this.db.get("_design/"+e[0],function(d,f){if(b.isCancelled)return void c(null,{status:"cancelled"});if(d)return void c(d);if(f&&f.views&&f.views[e[1]]){var h=j(f.views[e[1]].map);return a.filter=h,void b.doChanges(a)}var i=f.views?"missing json key: "+e[1]:"missing json key: views";d||(d=new Error(i),d.status=g.MISSING_DOC.status,d.name=g.MISSING_DOC.name,d.error=!0),c(d)})}else{var f=a.filter.split("/");this.db.get("_design/"+f[0],function(d,e){if(b.isCancelled)return void c(null,{status:"cancelled"});if(d)return void c(d);if(e&&e.filters&&e.filters[f[1]]){var h=i(e.filters[f[1]]);return a.filter=h,void b.doChanges(a)}var j=e&&e.filters?"missing json key: "+f[1]:"missing json key: filters";return d||(d=new Error(j),d.status=g.MISSING_DOC.status,d.name=g.MISSING_DOC.name,d.error=!0),void c(d)})}}},{"./deps/errors":11,"./evalFilter":15,"./evalView":16,"./merge":18,"./utils":23,events:27}],7:[function(a,b){(function(c){function d(a){a&&c.debug&&console.error(a)}function e(a,b,c){if(!(this instanceof e))return new e(a,b,c);var j=this;("function"==typeof b||"undefined"==typeof b)&&(c=b,b={}),a&&"object"==typeof a&&(b=a,a=void 0),"undefined"==typeof c&&(c=d),b=b||{};var k=c;j.auto_compaction=b.auto_compaction,j.prefix=e.prefix,f.call(j),j.taskqueue=new h;var l=new i(function(d,f){c=function(a,b){return a?f(a):(delete b.then,void d(b))},b=g.clone(b);var h,i,k=b.name||a;return function(){try{if("string"!=typeof k)throw i=new Error("Missing/invalid DB name"),i.code=400,i;if(h=e.parseAdapter(k,b),b.originalName=k,b.name=h.name,b.prefix&&"http"!==h.adapter&&"https"!==h.adapter&&(b.name=b.prefix+b.name),b.adapter=b.adapter||h.adapter,j._adapter=b.adapter,j._db_name=k,!e.adapters[b.adapter])throw i=new Error("Adapter is missing"),i.code=404,i;if(!e.adapters[b.adapter].valid())throw i=new Error("Invalid Adapter"),i.code=404,i}catch(a){j.taskqueue.fail(a),j.changes=g.toPromise(function(b){b.complete&&b.complete(a)})}}(),i?f(i):(j.adapter=b.adapter,j.replicate={},j.replicate.from=function(a,b,c){return j.constructor.replicate(a,j,b,c)},j.replicate.to=function(a,b,c){return j.constructor.replicate(j,a,b,c)},j.sync=function(a,b,c){return j.constructor.sync(j,a,b,c)},j.replicate.sync=j.sync,j.destroy=g.adapterFun("destroy",function(a){var b=this;b.info(function(c,d){return c?a(c):void b.constructor.destroy(d.db_name,a)})}),e.adapters[b.adapter].call(j,b,function(a){function d(a){"destroyed"===a&&(j.emit("destroyed"),e.removeListener(k,d))
}return a?void(c&&(j.taskqueue.fail(a),c(a))):(e.on(k,d),j.emit("created",j),e.emit("created",b.originalName),j.taskqueue.ready(j),void c(null,j))}),b.skipSetup&&j.taskqueue.ready(j),void(g.isCordova()&&cordova.fireWindowEvent(b.name+"_pouch",{})))});l.then(function(a){k(null,a)},k),j.then=l.then.bind(l),j["catch"]=l["catch"].bind(l)}var f=a("./adapter"),g=a("./utils"),h=a("./taskqueue"),i=g.Promise;g.inherits(e,f),b.exports=e}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter":1,"./taskqueue":22,"./utils":23}],8:[function(a,b){function c(a,b){function c(b,c,d){if(a.binary||a.json||!a.processData||"string"==typeof b){if(!a.binary&&a.json&&"string"==typeof b)try{b=JSON.parse(b)}catch(e){return d(e)}}else b=JSON.stringify(b);Array.isArray(b)&&(b=b.map(function(a){var b;return a.ok?a:a.error&&"conflict"===a.error?(b=f.REV_CONFLICT,b.id=a.id,b):a.error&&"forbidden"===a.error?(b=f.FORBIDDEN,b.id=a.id,b.reason=a.reason,b):a.missing?(b=f.MISSING_DOC,b.missing=a.missing,b):a})),d(null,b,c)}function h(a,b){var c,d,e,g;try{c=JSON.parse(a.responseText);for(g in f)if(f.hasOwnProperty(g)&&f[g].name===c.error){e=f[g];break}e||(e=f.UNKNOWN_ERROR,a.status&&(e.status=a.status),a.statusText&&(a.name=a.statusText)),d=f.error(e,c.reason)}catch(h){for(var g in f)if(f.hasOwnProperty(g)&&f[g].status===a.status){e=f[g];break}e||(e=f.UNKNOWN_ERROR,a.status&&(e.status=a.status),a.statusText&&(a.name=a.statusText)),d=f.error(e)}a.withCredentials&&0===a.status&&(d.status=405,d.statusText="Method Not Allowed"),b(d)}var i=!1,j=g.getArguments(function(a){i||(b.apply(this,a),i=!0)});"function"==typeof a&&(j=a,a={}),a=g.clone(a);var k={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};if(a=g.extend(!0,k,a),"GET"===a.method&&!a.cache){var l=-1!==a.url.indexOf("?");a.url+=(l?"&":"?")+"_nonce="+g.uuid(16)}var m,n;n=a.xhr?new a.xhr:new XMLHttpRequest,n.open(a.method,a.url),n.withCredentials=!0,a.json&&(a.headers.Accept="application/json",a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.body&&a.processData&&"string"!=typeof a.body&&(a.body=JSON.stringify(a.body))),a.binary&&(n.responseType="arraybuffer");var o=function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toGMTString()}document.cookie=a+"="+b+d+"; path=/"};for(var p in a.headers)if("Cookie"===p){var q=a.headers[p].split("=");o(q[0],q[1],10)}else n.setRequestHeader(p,a.headers[p]);"body"in a||(a.body=null);var r=function(){i||(n.abort(),h(n,j))};if(n.onreadystatechange=function(){if(4===n.readyState&&!i)if(clearTimeout(m),n.status>=200&&n.status<300){var b;b=a.binary?e([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,c(b,n,j)}else h(n,j)},a.timeout>0&&(m=setTimeout(r,a.timeout),n.onprogress=function(){clearTimeout(m),m=setTimeout(r,a.timeout)},"undefined"==typeof d&&(d=-1!==Object.keys(n).indexOf("upload")),d&&(n.upload.onprogress=n.onprogress)),a.body&&a.body instanceof Blob){var s=new FileReader;s.onloadend=function(){for(var a="",b=new Uint8Array(this.result),c=b.byteLength,d=0;c>d;d++)a+=String.fromCharCode(b[d]);a=g.fixBinary(a),n.send(a)},s.readAsArrayBuffer(a.body)}else n.send(a.body);return{abort:r}}var d,e=a("./blob.js"),f=a("./errors"),g=a("../utils");b.exports=c},{"../utils":23,"./blob.js":9,"./errors":11}],9:[function(a,b){(function(a){function c(b,c){b=b||[],c=c||{};try{return new Blob(b,c)}catch(d){if("TypeError"!==d.name)throw d;for(var e=a.BlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder||a.WebKitBlobBuilder,f=new e,g=0;g<b.length;g+=1)f.append(b[g]);return f.getBlob(c.type)}}b.exports=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(a,b,c){function d(){this.store={}}function e(){this.store=new d}c.Map=d,c.Set=e,d.prototype.mangle=function(a){if("string"!=typeof a)throw new TypeError("key must be a string but Got "+a);return"$"+a},d.prototype.unmangle=function(a){return a.substring(1)},d.prototype.get=function(a){var b=this.mangle(a);return b in this.store?this.store[b]:void 0},d.prototype.set=function(a,b){var c=this.mangle(a);return this.store[c]=b,!0},d.prototype.has=function(a){var b=this.mangle(a);return b in this.store},d.prototype["delete"]=function(a){var b=this.mangle(a);return b in this.store?(delete this.store[b],!0):!1},d.prototype.forEach=function(a){var b=this,c=Object.keys(b.store);c.forEach(function(c){var d=b.store[c];c=b.unmangle(c),a(d,c)})},e.prototype.add=function(a){return this.store.set(a,!0)},e.prototype.has=function(a){return this.store.has(a)},e.prototype["delete"]=function(a){return this.store["delete"](a)}},{}],11:[function(a,b,c){function d(a){this.status=a.status,this.name=a.error,this.message=a.reason,this.error=!0}d.prototype__proto__=Error.prototype,d.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})},c.UNAUTHORIZED=new d({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),c.MISSING_BULK_DOCS=new d({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),c.MISSING_DOC=new d({status:404,error:"not_found",reason:"missing"}),c.REV_CONFLICT=new d({status:409,error:"conflict",reason:"Document update conflict"}),c.INVALID_ID=new d({status:400,error:"invalid_id",reason:"_id field must contain a string"}),c.MISSING_ID=new d({status:412,error:"missing_id",reason:"_id is required for puts"}),c.RESERVED_ID=new d({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),c.NOT_OPEN=new d({status:412,error:"precondition_failed",reason:"Database not open"}),c.UNKNOWN_ERROR=new d({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),c.BAD_ARG=new d({status:500,error:"badarg",reason:"Some query argument is invalid"}),c.INVALID_REQUEST=new d({status:400,error:"invalid_request",reason:"Request was invalid"}),c.QUERY_PARSE_ERROR=new d({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),c.DOC_VALIDATION=new d({status:500,error:"doc_validation",reason:"Bad special document member"}),c.BAD_REQUEST=new d({status:400,error:"bad_request",reason:"Something wrong with the request"}),c.NOT_AN_OBJECT=new d({status:400,error:"bad_request",reason:"Document must be a JSON object"}),c.DB_MISSING=new d({status:404,error:"not_found",reason:"Database not found"}),c.IDB_ERROR=new d({status:500,error:"indexed_db_went_bad",reason:"unknown"}),c.WSQ_ERROR=new d({status:500,error:"web_sql_went_bad",reason:"unknown"}),c.LDB_ERROR=new d({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),c.FORBIDDEN=new d({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),c.error=function(a,b,c){function d(){this.message=b,c&&(this.name=c)}return d.prototype=a,new d(b)}},{}],12:[function(a,b){(function(c,d){function e(a,b,c){if("function"==typeof a.slice)return a.slice(b,c);b=Math.floor(b||0),c=Math.floor(c||0);var d=a.byteLength;if(b=0>b?Math.max(b+d,0):Math.min(d,b),c=0>c?Math.max(c+d,0):Math.min(d,c),0>=c-b)return new ArrayBuffer(0);var e=new ArrayBuffer(c-b),f=new Uint8Array(e),g=new Uint8Array(a,b,c-b);return f.set(g),e}var f=a("crypto"),g=a("spark-md5"),h=d.setImmediate||d.setTimeout;b.exports=function(a,b){function d(){var c=k*i,f=c+i;c+i>=a.size&&(f=a.size),k++,j>k?(l.append(e(a,c,f)),h(d)):(l.append(e(a,c,f)),b(null,l.end()),l.destroy())}if(!c.browser)return void b(null,f.createHash("md5").update(a).digest("hex"));var i=Math.min(524288,a.length),j=Math.ceil(a.length/i),k=0,l=new g;d()}}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,crypto:26,"spark-md5":56}],13:[function(a,b){function c(a,b,c){return new e(function(e,f){return b&&"object"==typeof b&&(b=b._id),"string"!=typeof b?f(new Error("doc id is required")):void a.get(b,function(g,h){if(g)return"not_found"!==g.name?f(g):e(d(a,c({_id:b}),c));var i=c(h);return i?void e(d(a,i,c)):e(h)})})}function d(a,b,d){return a.put(b)["catch"](function(e){if("conflict"!==e.name)throw e;return c(a,b,d)})}var e=a("../utils").Promise;b.exports=function(a,b,d,e){return"function"!=typeof e?c(a,b,d):void c(a,b,d).then(function(a){e(null,a)},e)}},{"../utils":23}],14:[function(a,b){function c(a){return 0|Math.random()*a}function d(a,b){b=b||e.length;var d="",f=-1;if(a){for(;++f<a;)d+=e[c(b)];return d}for(;++f<36;)switch(f){case 8:case 13:case 18:case 23:d+="-";break;case 19:d+=e[3&c(16)|8];break;default:d+=e[c(16)]}return d}var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b.exports=d},{}],15:[function(_dereq_,module,exports){function evalFilter(input){return eval(["(function () { return ",input," })()"].join(""))}module.exports=evalFilter},{}],16:[function(_dereq_,module,exports){function evalView(input){return eval(["(function () {","  return function (doc) {","    var emitted = false;","    var emit = function (a, b) {","      emitted = true;","    };","    var view = "+input+";","    view(doc);","    if (emitted) {","      return true;","    }","  }","})()"].join("\n"))}module.exports=evalView},{}],17:[function(a,b){(function(c){var d=a("./setup");b.exports=d,d.ajax=a("./deps/ajax"),d.extend=a("pouchdb-extend"),d.utils=a("./utils"),d.Errors=a("./deps/errors"),d.replicate=a("./replicate").replicate,d.sync=a("./sync"),d.version=a("./version");var e=a("./adapters/http");if(d.adapter("http",e),d.adapter("https",e),d.adapter("idb",a("./adapters/idb")),d.adapter("websql",a("./adapters/websql")),d.plugin(a("pouchdb-mapreduce")),!c.browser){var f=a("./adapters/leveldb");d.adapter("ldb",f),d.adapter("leveldb",f)}}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./adapters/http":2,"./adapters/idb":3,"./adapters/leveldb":26,"./adapters/websql":5,"./deps/ajax":8,"./deps/errors":11,"./replicate":19,"./setup":20,"./sync":21,"./utils":23,"./version":24,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"pouchdb-extend":47,"pouchdb-mapreduce":50}],18:[function(a,b){function c(a){for(var b,c=a.shift(),d=[c.id,c.opts,[]],e=d;a.length;)c=a.shift(),b=[c.id,c.opts,[]],e[2].push(b),e=b;return d}function d(a,b){for(var c=[{tree1:a,tree2:b}],d=!1;c.length>0;){var e=c.pop(),f=e.tree1,g=e.tree2;(f[1].status||g[1].status)&&(f[1].status="available"===f[1].status||"available"===g[1].status?"available":"missing");for(var h=0;h<g[2].length;h++)if(f[2][0]){for(var i=!1,j=0;j<f[2].length;j++)f[2][j][0]===g[2][h][0]&&(c.push({tree1:f[2][j],tree2:g[2][h]}),i=!0);i||(d="new_branch",f[2].push(g[2][h]),f[2].sort())}else d="new_leaf",f[2][0]=g[2][h]}return{conflicts:d,tree:a}}function e(a,b,c){var e,f=[],g=!1,h=!1;return a.length?(a.forEach(function(a){if(a.pos===b.pos&&a.ids[0]===b.ids[0])e=d(a.ids,b.ids),f.push({pos:a.pos,ids:e.tree}),g=g||e.conflicts,h=!0;else if(c!==!0){var i=a.pos<b.pos?a:b,j=a.pos<b.pos?b:a,k=j.pos-i.pos,l=[],m=[];for(m.push({ids:i.ids,diff:k,parent:null,parentIdx:null});m.length>0;){var n=m.pop();0!==n.diff?n.ids&&n.ids[2].forEach(function(a,b){m.push({ids:a,diff:n.diff-1,parent:n.ids,parentIdx:b})}):n.ids[0]===j.ids[0]&&l.push(n)}var o=l[0];o?(e=d(o.ids,j.ids),o.parent[2][o.parentIdx]=e.tree,f.push({pos:i.pos,ids:i.ids}),g=g||e.conflicts,h=!0):f.push(a)}else f.push(a)}),h||f.push(b),f.sort(function(a,b){return a.pos-b.pos}),{tree:f,conflicts:g||"internal_node"}):{tree:[b],conflicts:"new_leaf"}}function f(a,b){var d=h.rootToLeaf(a).map(function(a){var d=a.ids.slice(-b);return{pos:a.pos+(a.ids.length-d.length),ids:c(d)}});return d.reduce(function(a,b){return e(a,b,!0).tree},[d.shift()])}var g=a("pouchdb-extend"),h={};h.merge=function(a,b,c){a=g(!0,[],a),b=g(!0,{},b);var d=e(a,b);return{tree:f(d.tree,c),conflicts:d.conflicts}},h.winningRev=function(a){var b=[];return h.traverseRevTree(a.rev_tree,function(a,c,d,e,f){a&&b.push({pos:c,id:d,deleted:!!f.deleted})}),b.sort(function(a,b){return a.deleted!==b.deleted?a.deleted>b.deleted?1:-1:a.pos!==b.pos?b.pos-a.pos:a.id<b.id?1:-1}),b[0].pos+"-"+b[0].id},h.traverseRevTree=function(a,b){for(var c,d=a.slice();c=d.pop();)for(var e=c.pos,f=c.ids,g=f[2],h=b(0===g.length,e,f[0],c.ctx,f[1]),i=0,j=g.length;j>i;i++)d.push({pos:e+1,ids:g[i],ctx:h})},h.collectLeaves=function(a){var b=[];return h.traverseRevTree(a,function(a,c,d,e,f){a&&b.unshift({rev:c+"-"+d,pos:c,opts:f})}),b.sort(function(a,b){return b.pos-a.pos}),b.map(function(a){delete a.pos}),b},h.collectConflicts=function(a){var b=h.winningRev(a),c=h.collectLeaves(a.rev_tree),d=[];return c.forEach(function(a){a.rev===b||a.opts.deleted||d.push(a.rev)}),d},h.rootToLeaf=function(a){var b=[];return h.traverseRevTree(a,function(a,c,d,e,f){if(e=e?e.slice(0):[],e.push({id:d,opts:f}),a){var g=c+1-e.length;b.unshift({pos:g,ids:e})}return e}),b},b.exports=h},{"pouchdb-extend":47}],19:[function(a,b,c){function d(){m.call(this),this.cancelled=!1;var a=this,b=new k.Promise(function(b,c){a.once("complete",b),a.once("error",c)});a.then=function(a,c){return b.then(a,c)},a["catch"]=function(a){return b["catch"](a)},a["catch"](function(){})}function e(a,b,c){var d=c.filter?c.filter.toString():"";return a.id().then(function(a){return b.id().then(function(b){var e=a+b+d+JSON.stringify(c.query_params)+c.doc_ids;return k.MD5(e).then(function(a){return"_local/"+a})})})}function f(a,b,c,d){return a.get(b)["catch"](function(a){if(404===a.status)return{_id:b};throw a}).then(function(b){return d.cancelled?void 0:(b.last_seq=c,a.put(b))})}function g(a,b,c,d){this.src=a,this.target=b,this.id=c,this.returnValue=d}function h(a,b,c,d,e){function f(){if(0!==w.docs.length){var a=w.docs;return c.bulkDocs({docs:a},{new_edits:!1}).then(function(a){if(e.cancelled)throw q(),new Error("cancelled");var b=[];if(a.forEach(function(a){a.ok||(K.doc_write_failures++,b.push(new Error(a.reason||a.message||"Unknown reason")))}),b.length>0){var c=new Error("bulkDocs error");throw c.other_errors=b,p("target.bulkDocs failed to write docs",c),new Error("bulkWrite partial failure")}},function(b){throw K.doc_write_failures+=a.length,b})}}function h(){var a=Object.keys(w.diffs);if(!a.length)return k.Promise.resolve();var b=new k.Map;return w.changes.forEach(function(a){b.set(a.id,a.doc)}),k.Promise.all(a.map(function(a){return i(a,b.get(a))})).then(function(a){a.forEach(function(a){a.forEach(j)})})}function i(a,c){var d=w.diffs[a].missing,e=d.length>1||d[0]!==c._rev;return c._deleted||c._attachments||e?b.get(a,{revs:!0,open_revs:"all",attachments:!0}).then(function(a){var b={};return d.forEach(function(a){b[a]=!0}),a.filter(function(a){var c=a.ok?a.ok._rev:a.missing;return b[c]})}):[{ok:c}]}function j(a){var b=w.diffs;return e.cancelled?q():void(a.ok&&(K.docs_read++,w.pendingRevs++,w.docs.push(a.ok),delete b[a.ok._id]))}function l(){return z=!0,J.writeCheckpoint(w.seq).then(function(){if(z=!1,e.cancelled)throw q(),new Error("cancelled");K.last_seq=C=w.seq,K.docs_written+=w.docs.length,e.emit("change",k.clone(K)),w=void 0,u()})["catch"](function(a){throw z=!1,p("writeCheckpoint completed with error",a),a})}function m(){var a={};return w.changes.forEach(function(b){a[b.id]=b.changes.map(function(a){return a.rev})}),c.revsDiff(a).then(function(a){if(e.cancelled)throw q(),new Error("cancelled");w.diffs=a,w.pendingRevs=0})}function n(){if(!e.cancelled&&!w){if(0===x.length)return void o(!0);w=x.shift(),m().then(h).then(f).then(l).then(n)["catch"](function(a){p("batch processing terminated with error",a)})}}function o(a){return 0===y.changes.length?void(0!==x.length||w||((D&&L.live||A)&&e.emit("uptodate",k.clone(K)),A&&q())):void((a||A||y.changes.length>=E)&&(x.push(y),y={seq:0,changes:[],docs:[]},n()))}function p(a,b){B||(K.ok=!1,K.status="aborted",K.errors.push(b),x=[],y={seq:0,changes:[],docs:[]},q())}function q(){if(!(B||e.cancelled&&(K.status="cancelled",z))){if(K.status=K.status||"complete",K.end_time=new Date,K.last_seq=C,B=e.cancelled=!0,K.errors.length>0){var a=K.errors.pop();K.errors.length>0&&(a.other_errors=K.errors),a.result=K,e.emit("error",a)}else e.emit("complete",K);e.removeAllListeners()}}function r(a){return e.cancelled?q():(H++,0!==y.changes.length||0!==x.length||w||e.emit("outofdate",k.clone(K)),y.seq=a.seq,y.changes.push(a),void o(0===x.length))}function s(a){return G=!1,e.cancelled?q():(H>0?(L.since=a.last_seq,u()):D?(L.live=!0,u()):A=!0,void o(!0))}function t(a){return G=!1,e.cancelled?q():void p("changes rejected",a)}function u(){!G&&!A&&x.length<F&&(G=!0,H=0,b.changes(L).on("change",r).then(s)["catch"](t))}function v(){J.getCheckpoint().then(function(a){C=a,L={since:C,limit:E,batch_size:E,style:"all_docs",doc_ids:I,returnDocs:!1,include_docs:!0},d.filter&&(L.filter=d.filter),d.query_params&&(L.query_params=d.query_params),u()})["catch"](function(a){p("getCheckpoint rejected with ",a)})}var w,x=[],y={seq:0,changes:[],docs:[]},z=!1,A=!1,B=!1,C=0,D=d.continuous||d.live||!1,E=d.batch_size||100,F=d.batches_limit||10,G=!1,H=0,I=d.doc_ids,J=new g(b,c,a,e),K={ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]},L={};e.ready(b,c),e.once("cancel",q),"function"==typeof d.onChange&&e.on("change",d.onChange),"function"==typeof d.complete&&(e.once("error",d.complete),e.once("complete",function(a){d.complete(null,a)})),"undefined"==typeof d.since?v():(z=!0,J.writeCheckpoint(d.since).then(function(){return z=!1,e.cancelled?void q():(C=d.since,void v())})["catch"](function(a){throw z=!1,p("writeCheckpoint completed with error",a),a}))}function i(a,b){return"string"==typeof a?new b(a):a.then?a:k.Promise.resolve(a)}function j(a,b,c,f){"function"==typeof c&&(f=c,c={}),"undefined"==typeof c&&(c={}),c.complete||(c.complete=f||function(){}),c=k.clone(c),c.continuous=c.continuous||c.live;var g=new d(c),j=c.pouchConstructor||l;return i(a,j).then(function(a){return i(b,j).then(function(b){return e(a,b,c).then(function(d){h(d,a,b,c,g)})})})["catch"](function(a){g.emit("error",a),c.complete(a)}),g}var k=a("./utils"),l=a("./index"),m=a("events").EventEmitter;k.inherits(d,m),d.prototype.cancel=function(){this.cancelled=!0,this.emit("cancel")},d.prototype.ready=function(a,b){function c(){e.cancel()}function d(){a.removeListener("destroyed",c),b.removeListener("destroyed",c)}var e=this;a.once("destroyed",c),b.once("destroyed",c),this.then(d,d)},g.prototype.writeCheckpoint=function(a){var b=this;return this.updateTarget(a).then(function(){return b.updateSource(a)})},g.prototype.updateTarget=function(a){return f(this.target,this.id,a,this.returnValue)},g.prototype.updateSource=function(a){var b=this;return this.readOnlySource?k.Promise.resolve(!0):f(this.src,this.id,a,this.returnValue)["catch"](function(a){var c="number"==typeof a.status&&4===Math.floor(a.status/100);if(c)return b.readOnlySource=!0,!0;throw a})},g.prototype.getCheckpoint=function(){var a=this;return a.target.get(a.id).then(function(b){return a.src.get(a.id).then(function(a){return b.last_seq===a.last_seq?a.last_seq:0},function(c){if(404===c.status&&b.last_seq)return a.src.put({_id:a.id,last_seq:0}).then(function(){return 0},function(c){return 401===c.status?(a.readOnlySource=!0,b.last_seq):0});throw c})})["catch"](function(a){if(404!==a.status)throw a;return 0})},c.replicate=j},{"./index":17,"./utils":23,events:27}],20:[function(a,b){(function(c){var d=a("./constructor"),e=a("./utils"),f=e.Promise,g=a("events").EventEmitter;d.adapters={},d.preferredAdapters=a("./adapters/preferredAdapters.js"),d.prefix="_pouch_";var h=new g,i=["on","addListener","emit","listeners","once","removeAllListeners","removeListener","setMaxListeners"];i.forEach(function(a){d[a]=h[a].bind(h)}),d.setMaxListeners(0),d.parseAdapter=function(a,b){var f,g,h=a.match(/([a-z\-]*):\/\/(.*)/);if(h){if(a=/http(s?)/.test(h[1])?h[1]+"://"+h[2]:h[2],f=h[1],!d.adapters[f].valid())throw"Invalid adapter";return{name:a,adapter:h[1]}}var i="idb"in d.adapters&&"websql"in d.adapters&&e.hasLocalStorage()&&c.localStorage["_pouch__websqldb_"+d.prefix+a];if("undefined"!=typeof b&&b.db)g="leveldb";else for(var j=0;j<d.preferredAdapters.length;++j)if(g=d.preferredAdapters[j],g in d.adapters){if(i&&"idb"===g)continue;break}if(f=d.adapters[g],g&&f){var k="use_prefix"in f?f.use_prefix:!0;return{name:k?d.prefix+a:a,adapter:g}}throw"No valid adapter found"},d.destroy=e.toPromise(function(a,b,c){function g(){j.destroy(m,b,function(b,e){b?c(b):(d.emit("destroyed",a),d.emit(a,"destroyed"),c(null,e||{ok:!0}))})}("function"==typeof b||"undefined"==typeof b)&&(c=b,b={}),a&&"object"==typeof a&&(b=a,a=void 0);var h=d.parseAdapter(b.name||a,b),i=h.name,j=d.adapters[h.adapter],k="use_prefix"in j?j.use_prefix:!0,l=k?i.replace(new RegExp("^"+d.prefix),""):i,m=("http"===h.adapter||"https"===h.adapter?"":b.prefix||"")+i,n=e.extend(!0,{},b,{adapter:h.adapter});new d(l,n,function(a,i){return a?c(a):void i.get("_local/_pouch_dependentDbs",function(a,i){if(a)return"not_found"!==a.name?c(a):g();var j=i.dependentDbs,l=Object.keys(j).map(function(a){var c=k?a.replace(new RegExp("^"+d.prefix),""):a,f=e.extend(!0,b,{adapter:h.adapter});return d.destroy(c,f)});f.all(l).then(g,function(a){c(a)})})})}),d.allDbs=e.toPromise(function(a){var b=new Error("allDbs method removed");b.stats="400",a(b)}),d.adapter=function(a,b){b.valid()&&(d.adapters[a]=b)},d.plugin=function(a){Object.keys(a).forEach(function(b){d.prototype[b]=a[b]})},d.defaults=function(a){function b(b,c,f){("function"==typeof c||"undefined"==typeof c)&&(f=c,c={}),b&&"object"==typeof b&&(c=b,b=void 0),c=e.extend(!0,{},a,c),d.call(this,b,c,f)}return e.inherits(b,d),b.destroy=e.toPromise(function(b,c,f){return("function"==typeof c||"undefined"==typeof c)&&(f=c,c={}),b&&"object"==typeof b&&(c=b,b=void 0),c=e.extend(!0,{},a,c),d.destroy(b,c,f)}),i.forEach(function(a){b[a]=h[a].bind(h)}),b.setMaxListeners(0),b.preferredAdapters=d.preferredAdapters.slice(),Object.keys(d).forEach(function(a){a in b||(b[a]=d[a])}),b.replicate=function(a,c,f,g){return"function"==typeof f&&(g=f,f={}),"undefined"==typeof f&&(f={}),f=e.clone(f),f.pouchConstructor=b,d.replicate(a,c,f,g)},b},b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapters/preferredAdapters.js":4,"./constructor":7,"./utils":23,events:27}],21:[function(a,b){function c(a,b,f,g){function h(a){o||(o=!0,l.emit("cancel",a))}function i(a){l.emit("change",{direction:"pull",change:a})}function j(a){l.emit("change",{direction:"push",change:a})}function k(a){return function(b,c){var d="change"===b&&(c===i||c===j),e="cancel"===b&&c===h,f=b in p&&c===p[b];(d||e||f)&&(b in q||(q[b]={}),q[b][a]=!0,2===Object.keys(q[b]).length&&l.removeAllListeners(b))}}if(!(this instanceof c))return new c(a,b,f,g);var l=this;"function"==typeof f&&(g=f,f={}),"undefined"==typeof f&&(f={}),this.canceled=!1,f=d.clone(f);var m,n;"onChange"in f&&(m=f.onChange,delete f.onChange),"function"!=typeof g||f.complete?"complete"in f&&(n=f.complete,delete f.complete):n=g,this.push=e(a,b,f),this.pull=e(b,a,f);var o=!1,p={},q={};this.on("newListener",function(a){"change"===a?(l.pull.on("change",i),l.push.on("change",j)):"cancel"===a?(l.pull.on("cancel",h),l.push.on("cancel",h)):"error"===a||"removeListener"===a||"complete"===a||a in p||(p[a]=function(b){l.emit(a,b)},l.pull.on(a,p[a]),l.push.on(a,p[a]))}),this.on("removeListener",function(a){"change"===a?(l.pull.removeListener("change",i),l.push.removeListener("change",j)):"cancel"===a?(l.pull.removeListener("cancel",h),l.push.removeListener("cancel",h)):a in p&&"function"==typeof p[a]&&(l.pull.removeListener(a,p[a]),l.push.removeListener(a,p[a]),delete p[a])}),this.pull.on("removeListener",k("pull")),this.push.on("removeListener",k("push"));var r=d.Promise.all([this.push,this.pull]).then(function(a){var b={push:a[0],pull:a[1]};return l.emit("complete",b),n&&n(null,b),l.removeAllListeners(),b},function(a){throw l.cancel(),l.emit("error",a),n&&n(a),l.removeAllListeners(),a});this.then=function(a,b){return r.then(a,b)},this["catch"]=function(a){return r["catch"](a)}}var d=a("./utils"),e=a("./replicate").replicate,f=a("events").EventEmitter;b.exports=c,d.inherits(c,f),c.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}},{"./replicate":19,"./utils":23,events:27}],22:[function(a,b){function c(){this.isReady=!1,this.failed=!1,this.queue=[]}b.exports=c,c.prototype.execute=function(){var a,b;if(this.failed)for(;a=this.queue.shift();)"function"!=typeof a?(b=a.parameters[a.parameters.length-1],"function"==typeof b?b(this.failed):"changes"===a.name&&"function"==typeof b.complete&&b.complete(this.failed)):a(this.failed);else if(this.isReady)for(;a=this.queue.shift();)"function"==typeof a?a():a.task=this.db[a.name].apply(this.db,a.parameters)},c.prototype.fail=function(a){this.failed=a,this.execute()},c.prototype.ready=function(a){return this.failed?!1:0===arguments.length?this.isReady:(this.isReady=a?!0:!1,this.db=a,void this.execute())},c.prototype.addTask=function(a,b){if("function"!=typeof a){var c={name:a,parameters:b};return this.queue.push(c),this.failed&&this.execute(),c}this.queue.push(a),this.failed&&this.execute()}},{}],23:[function(a,b,c){(function(b,d){function e(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function f(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function g(){if(!(this instanceof g))return new g;var a=this;k.call(this),this.isChrome=f(),this.listeners={},this.hasLocal=!1,this.isChrome||(this.hasLocal=c.hasLocalStorage()),this.isChrome?chrome.storage.onChanged.addListener(function(b){null!=b.db_name&&a.emit(b.dbName.newValue)}):this.hasLocal&&(d.addEventListener?d.addEventListener("storage",function(b){a.emit(b.key)}):d.attachEvent("storage",function(b){a.emit(b.key)}))}var h=a("./merge");c.extend=a("pouchdb-extend"),c.ajax=a("./deps/ajax"),c.createBlob=a("./deps/blob"),c.uuid=a("./deps/uuid"),c.getArguments=a("argsarray");var i=a("./deps/buffer"),j=a("./deps/errors"),k=a("events").EventEmitter,l=a("./deps/collections");c.Map=l.Map,c.Set=l.Set,c.Promise="function"==typeof d.Promise?d.Promise:a("bluebird");var m=c.Promise,n=e(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);c.clone=function(a){return c.extend(!0,{},a)},c.inherits=a("inherits"),c.invalidIdError=function(a){var b;if(a?"string"!=typeof a?(b=new TypeError(j.INVALID_ID.message),b.status=400):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=new TypeError(j.RESERVED_ID.message),b.status=400):(b=new TypeError(j.MISSING_ID.message),b.status=412),b)throw b},c.call=c.getArguments(function(a){if(a.length){var b=a.shift();"function"==typeof b&&b.apply(this,a)}}),c.isLocalId=function(a){return/^_local/.test(a)},c.isDeleted=function(a,b){b||(b=h.winningRev(a));var c=b.indexOf("-");-1!==c&&(b=b.substring(c+1));var d=!1;return h.traverseRevTree(a.rev_tree,function(a,c,e,f,g){e===b&&(d=!!g.deleted)}),d},c.filterChange=function(a){return function(b){var c={},d=a.filter&&"function"==typeof a.filter;if(c.query=a.query_params,a.filter&&d&&!a.filter.call(this,b.doc,c))return!1;if(a.doc_ids&&-1===a.doc_ids.indexOf(b.id))return!1;if(a.include_docs)for(var e in b.doc._attachments)b.doc._attachments.hasOwnProperty(e)&&(b.doc._attachments[e].stub=!0);else delete b.doc;return!0}},c.parseDoc=function(a,b){var d,e,f,g,h={status:"available"};if(a._deleted&&(h.deleted=!0),b)if(a._id||(a._id=c.uuid()),e=c.uuid(32,16).toLowerCase(),a._rev){if(f=/^(\d+)-(.+)$/.exec(a._rev),!f){var i=new TypeError("invalid value for property '_rev'");i.status=400}a._rev_tree=[{pos:parseInt(f[1],10),ids:[f[2],{status:"missing"},[[e,h,[]]]]}],d=parseInt(f[1],10)+1}else a._rev_tree=[{pos:1,ids:[e,h,[]]}],d=1;else if(a._revisions&&(a._rev_tree=[{pos:a._revisions.start-a._revisions.ids.length+1,ids:a._revisions.ids.reduce(function(a,b){return null===a?[b,h,[]]:[b,{status:"missing"},[a]]},null)}],d=a._revisions.start,e=a._revisions.ids[0]),!a._rev_tree){if(f=/^(\d+)-(.+)$/.exec(a._rev),!f)throw g=new TypeError(j.BAD_ARG.message),g.status=j.BAD_ARG.status,g;d=parseInt(f[1],10),e=f[2],a._rev_tree=[{pos:parseInt(f[1],10),ids:[f[2],h,[]]}]}c.invalidIdError(a._id),a._rev=[d,e].join("-");var k={metadata:{},data:{}};for(var l in a)if(a.hasOwnProperty(l)){var m="_"===l[0];if(m&&!n[l])throw g=new Error(j.DOC_VALIDATION.message+": "+l),g.status=j.DOC_VALIDATION.status,g;m&&"_attachments"!==l?k.metadata[l.slice(1)]=a[l]:k.data[l]=a[l]}return k},c.isCordova=function(){return"undefined"!=typeof cordova||"undefined"!=typeof PhoneGap||"undefined"!=typeof phonegap},c.hasLocalStorage=function(){if(f())return!1;try{return d.localStorage}catch(a){return!1}},c.Changes=g,c.inherits(g,k),g.prototype.addListener=function(a,b,d,e){function f(){d.changes({include_docs:e.include_docs,conflicts:e.conflicts,continuous:!1,descending:!1,filter:e.filter,view:e.view,since:e.since,query_params:e.query_params,onChange:function(a){a.seq>e.since&&!e.cancelled&&(e.since=a.seq,c.call(e.onChange,a))}})}this.listeners[b]||(this.listeners[b]=f,this.on(a,f))},g.prototype.removeListener=function(a,b){b in this.listeners&&k.prototype.removeListener.call(this,a,this.listeners[b])},g.prototype.notifyLocalWindows=function(a){this.isChrome?chrome.storage.local.set({dbName:a}):this.hasLocal&&(localStorage[a]="a"===localStorage[a]?"b":"a")},g.prototype.notify=function(a){this.emit(a),this.notifyLocalWindows(a)},c.atob=b.browser&&"atob"in d?function(a){return atob(a)}:function(a){var b=new i(a,"base64");if(b.toString("base64")!==a)throw"Cannot base64 encode full string";return b.toString("binary")},c.btoa=b.browser&&"btoa"in d?function(a){return btoa(a)}:function(a){return new i(a,"binary").toString("base64")},c.fixBinary=function(a){if(!b.browser)return a;for(var c=a.length,d=new ArrayBuffer(c),e=new Uint8Array(d),f=0;c>f;f++)e[f]=a.charCodeAt(f);return d},c.once=function(a){var b=!1;return c.getArguments(function(c){if(b)throw"function"==typeof console.trace&&console.trace(),new Error("once called  more than once");b=!0,a.apply(this,c)})},c.toPromise=function(a){return c.getArguments(function(d){var e,f=this,g="function"==typeof d[d.length-1]?d.pop():!1;g&&(e=function(a,c){b.nextTick(function(){g(a,c)})});var h=new m(function(b,e){var g;try{var h=c.once(function(a,c){a?e(a):b(c)});d.push(h),g=a.apply(f,d),g&&"function"==typeof g.then&&b(g)}catch(i){e(i)}});return e&&h.then(function(a){e(null,a)},e),h.cancel=function(){return this},h})},c.adapterFun=function(a,b){return c.toPromise(c.getArguments(function(d){if(this._closed)return m.reject(new Error("database is closed"));var e=this;return this.taskqueue.isReady?b.apply(this,d):new c.Promise(function(b,c){e.taskqueue.addTask(function(f){f?c(f):b(e[a].apply(e,d))})})}))},c.arrayBufferToBinaryString=function(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return b},c.cancellableFun=function(a,b,d){d=d?c.clone(!0,{},d):{};var e=new k,f=d.complete||function(){},g=d.complete=c.once(function(a,b){a?f(a):(e.emit("end",b),f(null,b)),e.removeAllListeners()}),h=d.onChange||function(){},i=0;b.on("destroyed",function(){e.removeAllListeners()}),d.onChange=function(a){h(a),a.seq<=i||(i=a.seq,e.emit("change",a),a.deleted?e.emit("delete",a):1===a.changes.length&&"1-"===a.changes[0].rev.slice(0,1)?e.emit("create",a):e.emit("update",a))};var j=new m(function(a,b){d.complete=function(c,d){c?b(c):a(d)}});return j.then(function(a){g(null,a)},g),j.cancel=function(){j.isCancelled=!0,b.taskqueue.isReady&&d.complete(null,{status:"cancelled"})},b.taskqueue.isReady?a(b,d,j):b.taskqueue.addTask(function(){j.isCancelled?d.complete(null,{status:"cancelled"}):a(b,d,j)
}),j.on=e.on.bind(e),j.once=e.once.bind(e),j.addListener=e.addListener.bind(e),j.removeListener=e.removeListener.bind(e),j.removeAllListeners=e.removeAllListeners.bind(e),j.setMaxListeners=e.setMaxListeners.bind(e),j.listeners=e.listeners.bind(e),j.emit=e.emit.bind(e),j},c.MD5=c.toPromise(a("./deps/md5"))}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./deps/ajax":8,"./deps/blob":9,"./deps/buffer":26,"./deps/collections":10,"./deps/errors":11,"./deps/md5":12,"./deps/uuid":14,"./merge":18,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,argsarray:25,bluebird:33,events:27,inherits:29,"pouchdb-extend":47}],24:[function(a,b){b.exports="3.0.2"},{}],25:[function(a,b){function c(a){return function(){var b=arguments.length;if(b){for(var c=[],d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}return a.call(this,[])}}b.exports=c},{}],26:[function(){},{}],27:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length))throw b=arguments[1],b instanceof Error?b:TypeError('Uncaught, unspecified "error" event.');if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],28:[function(a,b){var c=b.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},{}],29:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],30:[function(a,b){function c(){}b.exports=c},{}],31:[function(a,b){var c=a("./promise"),d=a("./reject"),e=a("./resolve"),f=a("./INTERNAL"),g=a("./handlers"),h=d(new TypeError("must be an array"));b.exports=function(a){function b(a,b){function c(a){j[b]=a,++k===d&!i&&(i=!0,g.resolve(m,j))}e(a).then(c,function(a){i||(i=!0,g.reject(m,a))})}if("[object Array]"!==Object.prototype.toString.call(a))return h;var d=a.length,i=!1;if(!d)return e([]);for(var j=new Array(d),k=0,l=-1,m=new c(f);++l<d;)b(a[l],l);return m}},{"./INTERNAL":30,"./handlers":32,"./promise":34,"./reject":36,"./resolve":37}],32:[function(a,b,c){function d(a){var b=a&&a.then;return a&&"object"==typeof a&&"function"==typeof b?function(){b.apply(a,arguments)}:void 0}var e=a("./tryCatch"),f=a("./resolveThenable"),g=a("./states");c.resolve=function(a,b){var h=e(d,b);if("error"===h.status)return c.reject(a,h.value);var i=h.value;if(i)f.safely(a,i);else{a.state=g.FULFILLED,a.outcome=b;for(var j=-1,k=a.queue.length;++j<k;)a.queue[j].callFulfilled(b)}return a},c.reject=function(a,b){a.state=g.REJECTED,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a}},{"./resolveThenable":38,"./states":39,"./tryCatch":40}],33:[function(a,b,c){b.exports=c=a("./promise"),c.resolve=a("./resolve"),c.reject=a("./reject"),c.all=a("./all")},{"./all":31,"./promise":34,"./reject":36,"./resolve":37}],34:[function(a,b){function c(a){if(!(this instanceof c))return new c(a);if("function"!=typeof a)throw new TypeError("reslover must be a function");this.state=g.PENDING,this.queue=[],this.outcome=void 0,a!==e&&f.safely(this,a)}var d=a("./unwrap"),e=a("./INTERNAL"),f=a("./resolveThenable"),g=a("./states"),h=a("./queueItem");b.exports=c,c.prototype["catch"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){if("function"!=typeof a&&this.state===g.FULFILLED||"function"!=typeof b&&this.state===g.REJECTED)return this;var f=new c(e);if(this.state!==g.PENDING){var i=this.state===g.FULFILLED?a:b;d(f,i,this.outcome)}else this.queue.push(new h(f,a,b));return f}},{"./INTERNAL":30,"./queueItem":35,"./resolveThenable":38,"./states":39,"./unwrap":41}],35:[function(a,b){function c(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}var d=a("./handlers"),e=a("./unwrap");b.exports=c,c.prototype.callFulfilled=function(a){d.resolve(this.promise,a)},c.prototype.otherCallFulfilled=function(a){e(this.promise,this.onFulfilled,a)},c.prototype.callRejected=function(a){d.reject(this.promise,a)},c.prototype.otherCallRejected=function(a){e(this.promise,this.onRejected,a)}},{"./handlers":32,"./unwrap":41}],36:[function(a,b){function c(a){var b=new d(e);return f.reject(b,a)}var d=a("./promise"),e=a("./INTERNAL"),f=a("./handlers");b.exports=c},{"./INTERNAL":30,"./handlers":32,"./promise":34}],37:[function(a,b){function c(a){if(a)return a instanceof d?a:f.resolve(new d(e),a);var b=typeof a;switch(b){case"boolean":return g;case"undefined":return i;case"object":return h;case"number":return j;case"string":return k}}var d=a("./promise"),e=a("./INTERNAL"),f=a("./handlers");b.exports=c;var g=f.resolve(new d(e),!1),h=f.resolve(new d(e),null),i=f.resolve(new d(e),void 0),j=f.resolve(new d(e),0),k=f.resolve(new d(e),"")},{"./INTERNAL":30,"./handlers":32,"./promise":34}],38:[function(a,b,c){function d(a,b){function c(b){h||(h=!0,e.reject(a,b))}function d(b){h||(h=!0,e.resolve(a,b))}function g(){b(d,c)}var h=!1,i=f(g);"error"===i.status&&c(i.value)}var e=a("./handlers"),f=a("./tryCatch");c.safely=d},{"./handlers":32,"./tryCatch":40}],39:[function(a,b,c){c.REJECTED=["REJECTED"],c.FULFILLED=["FULFILLED"],c.PENDING=["PENDING"]},{}],40:[function(a,b){function c(a,b){var c={};try{c.value=a(b),c.status="success"}catch(d){c.status="error",c.value=d}return c}b.exports=c},{}],41:[function(a,b){function c(a,b,c){d(function(){var d;try{d=b(c)}catch(f){return e.reject(a,f)}d===a?e.reject(a,new TypeError("Cannot resolve promise with itself")):e.resolve(a,d)})}var d=a("immediate"),e=a("./handlers");b.exports=c},{"./handlers":32,immediate:42}],42:[function(a,b){function c(){e=!0;for(var a,b,c=h.length;c;){for(b=h,h=[],a=-1;++a<c;)b[a]();c=h.length}e=!1}function d(a){1!==h.push(a)||e||f()}for(var e,f,g=[a("./nextTick"),a("./mutation.js"),a("./messageChannel"),a("./stateChange"),a("./timeout")],h=[],i=-1,j=g.length;++i<j;)if(g[i]&&g[i].test&&g[i].test()){f=g[i].install(c);break}b.exports=d},{"./messageChannel":43,"./mutation.js":44,"./nextTick":26,"./stateChange":45,"./timeout":46}],43:[function(a,b,c){(function(a){c.test=function(){return a.setImmediate?!1:"undefined"!=typeof a.MessageChannel},c.install=function(b){var c=new a.MessageChannel;return c.port1.onmessage=b,function(){c.port2.postMessage(0)}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(a,b,c){(function(a){var b=a.MutationObserver||a.WebKitMutationObserver;c.test=function(){return b},c.install=function(c){var d=0,e=new b(c),f=a.document.createTextNode("");return e.observe(f,{characterData:!0}),function(){f.data=d=++d%2}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(a,b,c){(function(a){c.test=function(){return"document"in a&&"onreadystatechange"in a.document.createElement("script")},c.install=function(b){return function(){var c=a.document.createElement("script");return c.onreadystatechange=function(){b(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},a.document.documentElement.appendChild(c),b}}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(a,b,c){c.test=function(){return!0},c.install=function(a){return function(){setTimeout(a,0)}}},{}],47:[function(a,b){function c(a){return null===a?String(a):"object"==typeof a||"function"==typeof a?h[l.call(a)]||"object":typeof a}function d(a){return null!==a&&a===a.window}function e(a){if(!a||"object"!==c(a)||a.nodeType||d(a))return!1;try{if(a.constructor&&!m.call(a,"constructor")&&!m.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var e;for(e in a);return void 0===e||m.call(a,e)}function f(a){return"function"===c(a)}function g(){var a,b,c,d,h,i,j=arguments[0]||{},k=1,l=arguments.length,m=!1;for("boolean"==typeof j&&(m=j,j=arguments[1]||{},k=2),"object"==typeof j||f(j)||(j={}),l===k&&(j=this,--k);l>k;k++)if(null!=(a=arguments[k]))for(b in a)if(!(b in Object.prototype)){if(c=j[b],d=a[b],j===d)continue;m&&d&&(e(d)||(h=n(d)))?(h?(h=!1,i=c&&n(c)?c:[]):i=c&&e(c)?c:{},j[b]=g(m,i,d)):void 0!==d&&(n(a)&&f(d)||(j[b]=d))}return j}for(var h={},i=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],j=0;j<i.length;j++){var k=i[j];h["[object "+k+"]"]=k.toLowerCase()}var l=h.toString,m=h.hasOwnProperty,n=Array.isArray||function(a){return"array"===c(a)};b.exports=g},{}],48:[function(a,b){var c=a("./upsert"),d=a("./utils"),e=d.Promise;b.exports=function(a){var b=a.db,f=a.viewName,g=a.map,h=a.reduce,i=a.temporary,j=g.toString()+(h&&h.toString())+"undefined";if(!i&&b._cachedViews){var k=b._cachedViews[j];if(k)return e.resolve(k)}return b.info().then(function(a){function e(a){a.views=a.views||{};var b=f;-1===b.indexOf("/")&&(b=f+"/"+f);var c=a.views[b]=a.views[b]||{};return c[k]?void 0:(c[k]=!0,a)}var k=a.db_name+"-mrview-"+(i?"temp":d.MD5(j));return c(b,"_local/mrviews",e).then(function(){return b.registerDependentDatabase(k).then(function(a){var c=a.db;c.auto_compaction=!0;var d={name:k,db:c,sourceDB:b,adapter:b.adapter,mapFun:g,reduceFun:h};return d.db.get("_local/lastSeq")["catch"](function(a){if("not_found"!==a.name)throw a}).then(function(a){return d.seq=a?a.seq:0,i||(b._cachedViews=b._cachedViews||{},b._cachedViews[j]=d,d.db.on("destroyed",function(){delete b._cachedViews[j]})),d})})})})}},{"./upsert":54,"./utils":55}],49:[function(_dereq_,module,exports){module.exports=function(func,emit,sum,log,isArray,toJSON){return eval("'use strict'; ("+func.replace(/;\s*$/,"")+");")}},{}],50:[function(a,b,c){(function(b){function d(a){return-1===a.indexOf("/")?[a,a]:a.split("/")}function e(a,b,c){try{return{output:b.apply(null,c)}}catch(d){return a.emit("error",d),{error:d}}}function f(a,b){var c=x(a.key,b.key);return 0!==c?c:x(a.value,b.value)}function g(a,b,c){return c=c||0,"number"==typeof b?a.slice(c,b+c):c>0?a.slice(c):a}function h(a){var b=new Error("builtin "+a+" function requires map values to be numbers or number arrays");return b.name="invalid_value",b.status=500,b}function i(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];if("number"!=typeof e){if(!Array.isArray(e))throw h("_sum");b="number"==typeof b?[b]:b;for(var f=0,g=e.length;g>f;f++){var i=e[f];if("number"!=typeof i)throw h("_sum");"undefined"==typeof b[f]?b.push(i):b[f]+=i}}else"number"==typeof b?b+=e:b[0]+=e}return b}function j(a,b,c,d){var e=b[a];"undefined"!=typeof e&&(d&&(e=encodeURIComponent(JSON.stringify(e))),c.push(a+"="+e))}function k(a,b){var c=a.descending?"endkey":"startkey",d=a.descending?"startkey":"endkey";if("undefined"!=typeof a[c]&&"undefined"!=typeof a[d]&&x(a[c],a[d])>0)throw new s("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(b.reduce&&a.reduce!==!1){if(a.include_docs)throw new s("{include_docs:true} is invalid for reduce");if(a.keys&&a.keys.length>1&&!a.group&&!a.group_level)throw new s("Multi-key fetches for reduce views must use {group: true}")}if(a.group_level){if("number"!=typeof a.group_level)throw new s('Invalid value for integer: "'+a.group_level+'"');if(a.group_level<0)throw new s('Invalid value for positive integer: "'+a.group_level+'"')}}function l(a,b,c){var e,f=[],g="GET";if(j("reduce",c,f),j("include_docs",c,f),j("limit",c,f),j("descending",c,f),j("group",c,f),j("group_level",c,f),j("skip",c,f),j("stale",c,f),j("startkey",c,f,!0),j("endkey",c,f,!0),j("inclusive_end",c,f),j("key",c,f,!0),f=f.join("&"),f=""===f?"":"?"+f,"undefined"!=typeof c.keys){var h=2e3,i="keys="+encodeURIComponent(JSON.stringify(c.keys));i.length+f.length+1<=h?f+=("?"===f[0]?"&":"?")+i:(g="POST","string"==typeof b?e=JSON.stringify({keys:c.keys}):b.keys=c.keys)}if("string"==typeof b){var k=d(b);return a.request({method:g,url:"_design/"+k[0]+"/_view/"+k[1]+f,body:e})}return e=e||{},Object.keys(b).forEach(function(a){e[a]=Array.isArray(b[a])?b[a]:b[a].toString()}),a.request({method:"POST",url:"_temp_view"+f,body:e})}function m(a){return function(b){if("not_found"===b.name)return a;throw b}}function n(a,b,c){var d="_local/doc_"+a;return b.db.get(d)["catch"](m({_id:d,keys:[]})).then(function(d){return D.resolve().then(function(){return d.keys.length?b.db.allDocs({keys:d.keys,include_docs:!0}):{rows:[]}}).then(function(b){var e=b.rows.map(function(a){return a.doc}).filter(function(a){return a}),f=c[a],g={};e.forEach(function(a){g[a._id]=!0,a._deleted=!f[a._id],a._deleted||(a.value=f[a._id])});var h=Object.keys(f);return h.forEach(function(a){g[a]||e.push({_id:a,value:f[a]})}),d.keys=C.uniq(h.concat(d.keys)),e.splice(0,0,d),e})})}function o(a,b,c){var d="_local/lastSeq";return a.db.get(d)["catch"](m({_id:d,seq:0})).then(function(d){var e=Object.keys(b);return D.all(e.map(function(c){return n(c,a,b)})).then(function(b){var e=[];return b.forEach(function(a){e=e.concat(a)}),d.seq=c,e.push(d),a.db.bulkDocs({docs:e})})})}function p(a,b,c){0===c.group_level&&delete c.group_level;var d,f=c.group||c.group_level;d=H[a.reduceFun]?H[a.reduceFun]:B(a.reduceFun.toString(),null,i,u,Array.isArray,JSON.parse);var h=[],j=c.group_level;b.forEach(function(a){var b=h[h.length-1],c=f?a.key:null;return f&&Array.isArray(c)&&"number"==typeof j&&(c=c.length>j?c.slice(0,j):c),b&&0===x(b.key[0][0],c)?(b.key.push([c,a.id]),void b.value.push(a.value)):void h.push({key:[[c,a.id]],value:[a.value]})});for(var k=0,l=h.length;l>k;k++){var m=h[k],n=e(a.sourceDB,d,[m.key,m.value,!1]);m.value=n.error?null:n.output,m.key=m.key[0][0]}return{rows:g(h,c.limit,c.skip)}}function q(a){return a.request({method:"POST",url:"_view_cleanup"})}function r(a,c,e){if("http"===a.type())return l(a,c,e);if("string"!=typeof c){k(e,c);var f={db:a,viewName:"temp_view/temp_view",map:c.map,reduce:c.reduce,temporary:!0};return F.add(function(){return A(f).then(function(a){function b(){return a.db.destroy()}return C.fin(I(a).then(function(){return J(a,e)}),b)})}),F.finish()}var g=c,h=d(g),i=h[0],j=h[1];return a.get("_design/"+i).then(function(c){var d=c.views&&c.views[j];if(!d||"string"!=typeof d.map)throw new t("ddoc "+i+" has no view named "+j);k(e,d);var f={db:a,viewName:g,map:d.map,reduce:d.reduce};return A(f).then(function(a){return"ok"===e.stale||"update_after"===e.stale?("update_after"===e.stale&&b.nextTick(function(){I(a)}),J(a,e)):I(a).then(function(){return J(a,e)})})})}function s(a){this.status=400,this.name="query_parse_error",this.message=a,this.error=!0;try{Error.captureStackTrace(this,s)}catch(b){}}function t(a){this.status=404,this.name="not_found",this.message=a,this.error=!0;try{Error.captureStackTrace(this,t)}catch(b){}}var u,v=a("pouchdb-collate"),w=a("./taskqueue"),x=v.collate,y=v.toIndexableString,z=v.normalizeKey,A=a("./create-view"),B=a("./evalfunc");u="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var C=a("./utils"),D=C.Promise,E=new w,F=new w,G=50,H={_sum:function(a,b){return i(b)},_count:function(a,b){return b.length},_stats:function(a,b){function c(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];b+=e*e}return b}return{sum:i(b),min:Math.min.apply(null,b),max:Math.max.apply(null,b),count:b.length,sumsqr:c(b)}}},I=C.sequentialize(E,function(a){function b(a,b){d.push({id:g._id,key:z(a),value:z(b)})}function c(b,c){return function(){return o(a,b,c)}}var d,g,h;if("function"==typeof a.mapFun&&2===a.mapFun.length){var j=a.mapFun;h=function(a){return j(a,b)}}else h=B(a.mapFun.toString(),b,i,u,Array.isArray,JSON.parse);var k=a.seq||0,l=new w;return new D(function(b,i){function j(){l.finish().then(function(){a.seq=k,b()})}function m(){function b(a){i(a)}a.sourceDB.changes({conflicts:!0,include_docs:!0,since:k,limit:G}).on("complete",function(b){var i=b.results;if(!i.length)return j();for(var n={},o=0,p=i.length;p>o;o++){var q=i[o];if("_"!==q.doc._id[0]){d=[],g=q.doc,g._deleted||e(a.sourceDB,h,[g]),d.sort(f);for(var r={},s=0,t=d.length;t>s;s++){var u=d[s],v=y([u.key,u.id,s]);r[v]=u}n[q.doc._id]=r}k=q.seq}return l.add(c(n,k)),i.length<G?j():m()}).on("error",b)}m()})}),J=C.sequentialize(E,function(a,b){function c(b){return b.include_docs=!0,a.db.allDocs(b).then(function(a){return e=a.total_rows,a.rows.map(function(a){return a.doc.value})})}function d(c){var d;if(d=f?p(a,c,b):{total_rows:e,offset:g,rows:c},b.include_docs){var h=c.map(function(b){var c=b.value,d=c&&"object"==typeof c&&c._id||b.id;return a.sourceDB.get(d).then(function(a){b.doc=a},function(){})});return D.all(h).then(function(){return d})}return d}var e,f=a.reduceFun&&b.reduce!==!1,g=b.skip||0;"undefined"==typeof b.keys||b.keys.length||(b.limit=0,delete b.keys);var h=function(a){return a.reduce(function(a,b){return a.concat(b)})};if("undefined"!=typeof b.keys){var i=b.keys,j=i.map(function(a){var b={startkey:y([a]),endkey:y([a,{}])};return c(b)});return D.all(j).then(h).then(d)}var k={descending:b.descending};if("undefined"!=typeof b.startkey&&(k.startkey=y(b.descending?[b.startkey,{}]:[b.startkey])),"undefined"!=typeof b.endkey){var l=b.inclusive_end!==!1;b.descending&&(l=!l),k.endkey=y(l?[b.endkey,{}]:[b.endkey])}if("undefined"!=typeof b.key){var m=y([b.key]),n=y([b.key,{}]);k.descending?(k.endkey=m,k.startkey=n):(k.startkey=m,k.endkey=n)}return f||("number"==typeof b.limit&&(k.limit=b.limit),k.skip=g),c(k).then(d)}),K=C.sequentialize(E,function(a){return a.get("_local/mrviews").then(function(b){var c={};Object.keys(b.views).forEach(function(a){var b=d(a),e="_design/"+b[0],f=b[1];c[e]=c[e]||{},c[e][f]=!0});var e={keys:Object.keys(c),include_docs:!0};return a.allDocs(e).then(function(d){var e={};d.rows.forEach(function(a){var d=a.key.substring(8);Object.keys(c[a.key]).forEach(function(c){var f=d+"/"+c;b.views[f]||(f=c);var g=Object.keys(b.views[f]),h=a.doc&&a.doc.views&&a.doc.views[c];g.forEach(function(a){e[a]=e[a]||h})})});var f=Object.keys(e).filter(function(a){return!e[a]}),g=f.map(function(b){return a.constructor.destroy(b,{adapter:a.adapter})});return D.all(g).then(function(){return{ok:!0}})})},m({ok:!0}))});c.viewCleanup=C.callbackify(function(){var a=this;return"http"===a.type()?q(a):K(a)}),c.query=function(a,b,c){"function"==typeof b&&(c=b,b={}),b=C.extend(!0,{},b),"function"==typeof a&&(a={map:a});var d=this,e=D.resolve().then(function(){return r(d,a,b)});return C.promisedCallback(e,c),e},C.inherits(s,Error),C.inherits(t,Error)}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"./create-view":48,"./evalfunc":49,"./taskqueue":53,"./utils":55,"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,"pouchdb-collate":51}],51:[function(a,b,c){function d(a){if(null!==a)switch(typeof a){case"boolean":return a?1:0;case"number":return k(a);case"string":return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var b=Array.isArray(a),d=b?a:Object.keys(a),e=-1,f=d.length,g="";if(b)for(;++e<f;)g+=c.toIndexableString(d[e]);else for(;++e<f;){var h=d[e];g+=c.toIndexableString(h)+c.toIndexableString(a[h])}return g}return""}function e(a,b){var c,d=b,e="1"===a[b];if(e)c=0,b++;else{var f="0"===a[b];b++;var g="",h=a.substring(b,b+m),i=parseInt(h,10)+l;for(f&&(i=-i),b+=m;;){var j=a[b];if("\x00"===j)break;g+=j,b++}g=g.split("."),c=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),f&&(c-=10),0!==i&&(c=parseFloat(c+"e"+i))}return{num:c,length:b-d}}function f(a,b){var c=a.pop();if(b.length){var d=b[b.length-1];c===d.element&&(b.pop(),d=b[b.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(c);else if(f===a.length-2){var g=a.pop();e[g]=c}else a.push(c)}}function g(a,b){for(var d=Math.min(a.length,b.length),e=0;d>e;e++){var f=c.collate(a[e],b[e]);if(0!==f)return f}return a.length===b.length?0:a.length>b.length?1:-1}function h(a,b){return a===b?0:a>b?1:-1}function i(a,b){for(var d=Object.keys(a),e=Object.keys(b),f=Math.min(d.length,e.length),g=0;f>g;g++){var h=c.collate(d[g],e[g]);if(0!==h)return h;if(h=c.collate(a[d[g]],b[e[g]]),0!==h)return h}return d.length===e.length?0:d.length>e.length?1:-1}function j(a){var b=["boolean","number","string","object"],c=b.indexOf(typeof a);return~c?null===a?1:Array.isArray(a)?5:3>c?c+2:c+3:Array.isArray(a)?5:void 0}function k(a){if(0===a)return"1";var b=a.toExponential().split(/e\+?/),c=parseInt(b[1],10),d=0>a,e=d?"0":"2",f=(d?-c:c)-l,g=o.padLeft(f.toString(),"0",m);e+=n+g;var h=Math.abs(parseFloat(b[0]));d&&(h=10-h);var i=h.toFixed(20);return i=i.replace(/\.?0+$/,""),e+=n+i}var l=-324,m=3,n="",o=a("./utils");c.collate=function(a,b){if(a===b)return 0;a=c.normalizeKey(a),b=c.normalizeKey(b);var d=j(a),e=j(b);if(d-e!==0)return d-e;if(null===a)return 0;switch(typeof a){case"number":return a-b;case"boolean":return a===b?0:b>a?-1:1;case"string":return h(a,b)}return Array.isArray(a)?g(a,b):i(a,b)},c.normalizeKey=function(a){switch(typeof a){case"undefined":return null;case"number":return 1/0===a||a===-1/0||isNaN(a)?null:a;case"object":var b=a;if(Array.isArray(a)){var d=a.length;a=new Array(d);for(var e=0;d>e;e++)a[e]=c.normalizeKey(b[e])}else{if(a instanceof Date)return a.toJSON();if(null!==a){a={};for(var f in b)if(b.hasOwnProperty(f)){var g=b[f];"undefined"!=typeof g&&(a[f]=c.normalizeKey(g))}}}}return a},c.toIndexableString=function(a){var b="\x00";return a=c.normalizeKey(a),j(a)+n+d(a)+b},c.parseIndexableString=function(a){for(var b=[],c=[],d=0;;){var g=a[d++];if("\x00"!==g)switch(g){case"1":b.push(null);break;case"2":b.push("1"===a[d]),d++;break;case"3":var h=e(a,d);b.push(h.num),d+=h.length;break;case"4":for(var i="";;){var j=a[d];if("\x00"===j)break;i+=j,d++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),b.push(i);break;case"5":var k={element:[],index:b.length};b.push(k.element),c.push(k);break;case"6":var l={element:{},index:b.length};b.push(l.element),c.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}else{if(1===b.length)return b.pop();f(b,c)}}}},{"./utils":52}],52:[function(a,b,c){function d(a,b,c){for(var d="",e=c-a.length;d.length<e;)d+=b;return d}c.padLeft=function(a,b,c){var e=d(a,b,c);return e+a},c.padRight=function(a,b,c){var e=d(a,b,c);return a+e},c.stringLexCompare=function(a,b){var c,d=a.length,e=b.length;for(c=0;d>c;c++){if(c===e)return 1;var f=a.charAt(c),g=b.charAt(c);if(f!==g)return g>f?-1:1}return e>d?-1:0},c.intToDecimalForm=function(a){var b=0>a,c="";do{var d=b?-Math.ceil(a%10):Math.floor(a%10);c=d+c,a=b?Math.ceil(a/10):Math.floor(a/10)}while(a);return b&&"0"!==c&&(c="-"+c),c}},{}],53:[function(a,b){function c(){this.promise=new d(function(a){a()})}var d=a("./utils").Promise;c.prototype.add=function(a){return this.promise=this.promise["catch"](function(){}).then(function(){return a()}),this.promise},c.prototype.finish=function(){return this.promise},b.exports=c},{"./utils":55}],54:[function(a,b){function c(a,b,c){return new e(function(e,f){return b&&"object"==typeof b&&(b=b._id),"string"!=typeof b?f(new Error("doc id is required")):void a.get(b,function(g,h){if(g)return"not_found"!==g.name?f(g):e(d(a,c({_id:b}),c));var i=c(h);return i?void e(d(a,i,c)):e(h)})})}function d(a,b,d){return a.put(b)["catch"](function(e){if("conflict"!==e.name)throw e;return c(a,b,d)})}var e=a("./utils").Promise;b.exports=c},{"./utils":55}],55:[function(a,b,c){(function(b,d){c.Promise="function"==typeof d.Promise?d.Promise:a("lie"),c.uniq=function(a){var b={};return a.forEach(function(a){b[a]=!0}),Object.keys(b)},c.inherits=a("inherits"),c.extend=a("pouchdb-extend");var e=a("argsarray");c.promisedCallback=function(a,c){return c&&a.then(function(a){b.nextTick(function(){c(null,a)})},function(a){b.nextTick(function(){c(a)})}),a},c.callbackify=function(a){return e(function(b){var d=b.pop(),e=a.apply(this,b);return"function"==typeof d&&c.promisedCallback(e,d),e})},c.fin=function(a,b){return a.then(function(a){var c=b();return"function"==typeof c.then?c.then(function(){return a}):a},function(a){var c=b();if("function"==typeof c.then)return c.then(function(){throw a});throw a})},c.sequentialize=function(a,b){return function(){var c=arguments,d=this;return a.add(function(){return b.apply(d,c)})}};var f=a("crypto"),g=a("spark-md5");c.MD5=function(a){return b.browser?g.hash(a):f.createHash("md5").update(a).digest("hex")}}).call(this,a("/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"/Users/nolan/workspace/pouchdb/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":28,argsarray:25,crypto:26,inherits:29,lie:33,"pouchdb-extend":47,"spark-md5":56}],56:[function(a,b,c){!function(a){if("object"==typeof c)b.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var d;try{d=window}catch(e){d=self}d.SparkMD5=a()}}(function(){var a=function(a,b){return a+b&4294967295},b=function(b,c,d,e,f,g){return c=a(a(c,b),a(e,g)),a(c<<f|c>>>32-f,d)},c=function(a,c,d,e,f,g,h){return b(c&d|~c&e,a,c,f,g,h)},d=function(a,c,d,e,f,g,h){return b(c&e|d&~e,a,c,f,g,h)},e=function(a,c,d,e,f,g,h){return b(c^d^e,a,c,f,g,h)},f=function(a,c,d,e,f,g,h){return b(d^(c|~e),a,c,f,g,h)},g=function(b,g){var h=b[0],i=b[1],j=b[2],k=b[3];h=c(h,i,j,k,g[0],7,-680876936),k=c(k,h,i,j,g[1],12,-389564586),j=c(j,k,h,i,g[2],17,606105819),i=c(i,j,k,h,g[3],22,-1044525330),h=c(h,i,j,k,g[4],7,-176418897),k=c(k,h,i,j,g[5],12,1200080426),j=c(j,k,h,i,g[6],17,-1473231341),i=c(i,j,k,h,g[7],22,-45705983),h=c(h,i,j,k,g[8],7,1770035416),k=c(k,h,i,j,g[9],12,-1958414417),j=c(j,k,h,i,g[10],17,-42063),i=c(i,j,k,h,g[11],22,-1990404162),h=c(h,i,j,k,g[12],7,1804603682),k=c(k,h,i,j,g[13],12,-40341101),j=c(j,k,h,i,g[14],17,-1502002290),i=c(i,j,k,h,g[15],22,1236535329),h=d(h,i,j,k,g[1],5,-165796510),k=d(k,h,i,j,g[6],9,-1069501632),j=d(j,k,h,i,g[11],14,643717713),i=d(i,j,k,h,g[0],20,-373897302),h=d(h,i,j,k,g[5],5,-701558691),k=d(k,h,i,j,g[10],9,38016083),j=d(j,k,h,i,g[15],14,-660478335),i=d(i,j,k,h,g[4],20,-405537848),h=d(h,i,j,k,g[9],5,568446438),k=d(k,h,i,j,g[14],9,-1019803690),j=d(j,k,h,i,g[3],14,-187363961),i=d(i,j,k,h,g[8],20,1163531501),h=d(h,i,j,k,g[13],5,-1444681467),k=d(k,h,i,j,g[2],9,-51403784),j=d(j,k,h,i,g[7],14,1735328473),i=d(i,j,k,h,g[12],20,-1926607734),h=e(h,i,j,k,g[5],4,-378558),k=e(k,h,i,j,g[8],11,-2022574463),j=e(j,k,h,i,g[11],16,1839030562),i=e(i,j,k,h,g[14],23,-35309556),h=e(h,i,j,k,g[1],4,-1530992060),k=e(k,h,i,j,g[4],11,1272893353),j=e(j,k,h,i,g[7],16,-155497632),i=e(i,j,k,h,g[10],23,-1094730640),h=e(h,i,j,k,g[13],4,681279174),k=e(k,h,i,j,g[0],11,-358537222),j=e(j,k,h,i,g[3],16,-722521979),i=e(i,j,k,h,g[6],23,76029189),h=e(h,i,j,k,g[9],4,-640364487),k=e(k,h,i,j,g[12],11,-421815835),j=e(j,k,h,i,g[15],16,530742520),i=e(i,j,k,h,g[2],23,-995338651),h=f(h,i,j,k,g[0],6,-198630844),k=f(k,h,i,j,g[7],10,1126891415),j=f(j,k,h,i,g[14],15,-1416354905),i=f(i,j,k,h,g[5],21,-57434055),h=f(h,i,j,k,g[12],6,1700485571),k=f(k,h,i,j,g[3],10,-1894986606),j=f(j,k,h,i,g[10],15,-1051523),i=f(i,j,k,h,g[1],21,-2054922799),h=f(h,i,j,k,g[8],6,1873313359),k=f(k,h,i,j,g[15],10,-30611744),j=f(j,k,h,i,g[6],15,-1560198380),i=f(i,j,k,h,g[13],21,1309151649),h=f(h,i,j,k,g[4],6,-145523070),k=f(k,h,i,j,g[11],10,-1120210379),j=f(j,k,h,i,g[2],15,718787259),i=f(i,j,k,h,g[9],21,-343485551),b[0]=a(h,b[0]),b[1]=a(i,b[1]),b[2]=a(j,b[2]),b[3]=a(k,b[3])},h=function(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c},i=function(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c},j=function(a){var b,c,d,e,f,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,h(a.substring(b-64,b)));
for(a=a.substring(b-64),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),i=parseInt(e[1],16)||0,d[14]=f,d[15]=i,g(k,d),k},k=function(a){var b,c,d,e,f,h,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,i(a.subarray(b-64,b)));for(a=j>b-64?a.subarray(b-64):new Uint8Array(0),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a[b]<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),h=parseInt(e[1],16)||0,d[14]=f,d[15]=h,g(k,d),k},l=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],m=function(a){var b,c="";for(b=0;4>b;b+=1)c+=l[a>>8*b+4&15]+l[a>>8*b&15];return c},n=function(a){var b;for(b=0;b<a.length;b+=1)a[b]=m(a[b]);return a.join("")},o=function(a){return n(j(a))},p=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==o("hello")&&(a=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}),p.prototype.append=function(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),this.appendBinary(a),this},p.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var b,c=this._buff.length;for(b=64;c>=b;b+=64)g(this._state,h(this._buff.substring(b-64,b)));return this._buff=this._buff.substr(b-64),this},p.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=a?this._state:n(this._state),this.reset(),c},p.prototype._finish=function(a,b){var c,d,e,f=b;if(a[f>>2]|=128<<(f%4<<3),f>55)for(g(this._state,a),f=0;16>f;f+=1)a[f]=0;c=8*this._length,c=c.toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(c[2],16),e=parseInt(c[1],16)||0,a[14]=d,a[15]=e,g(this._state,a)},p.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},p.hash=function(a,b){/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a)));var c=j(a);return b?c:n(c)},p.hashBinary=function(a,b){var c=j(a);return b?c:n(c)},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(a){var b,c=this._concatArrayBuffer(this._buff,a),d=c.length;for(this._length+=a.byteLength,b=64;d>=b;b+=64)g(this._state,i(c.subarray(b-64,b)));return this._buff=d>b-64?c.subarray(b-64):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=a?this._state:n(this._state),this.reset(),c},p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._concatArrayBuffer=function(a,b){var c=a.length,d=new Uint8Array(c+b.byteLength);return d.set(a),d.set(new Uint8Array(b),c),d},p.ArrayBuffer.hash=function(a,b){var c=k(new Uint8Array(a));return b?c:n(c)},p})},{}]},{},[17])(17)}),angular.module("dashboardApp").controller("MainCtrl",["$scope","$http","Utils","$debounce","$location","Database","ngProgress","Authentication",function(a,b,c,d,e,f,g,h){function i(){a.SearchName={owner:"",name:"",village:""},console.log(a.date.firstVisit+" "+a.date.lastVisit),""===a.date.firstVisit&&""===a.date.lastVisit&&(a.dateFilterOn=!1)}a.responsiveWidth="900px",a.groups=[],a.loading=!0,a.showOption=1,a.filterOn=!1,a.SearchName={owner:"",name:"",village:""},a.search={owner:"",name:"",village:""},a.date={lastVisit:"",firstVisit:""},a.land={eland:"",fland:""},a.officers=[{name:"All",id:"all"},{name:"Ambadas Gavand",id:"a.z.gavand@gmail.com"},{name:"Digambar Bargaje",id:"d.k.bargaje1@gmail.com"},{name:"Mahavir Bajare",id:"m.s.bajare1@gmail.com"},{name:"Bhaiyya Sonawane",id:"sonawanebhaiyya51@gmail.com"},{name:"Sandip Patil",id:"pattilsandip007@gmail.com"},{name:"Kalyan Nikam",id:"kalyannikam5@gmail.com"},{name:"Vishal Pawar",id:"v.v.pawar12@gmail.com"},{name:"Jitendra Salunke",id:"jitusalunkhe86@gmail.com"},{name:"Milind Aher",id:"millindaaher@gmail.com"},{name:"Abbubakar Sayyed",id:"asayyed123456@gmail.com"},{name:"Vinod Ingle",id:"vinodinggle@gmail.com"},{name:"Anil Deshmane",id:"anilldeshhmane@gmail.com"},{name:"Ramesh Suryawanshi",id:"raameshsuuryawanshi@gmail.com"},{name:"Brahmadev Kadbhane",id:"brahmdevkadbhane@gmail.com"},{name:"Jayesh Raut",id:"j.d.raut12@gmail.com"},{name:"Pradeep Pathare",id:"pradeep.pathare12345@gmail.com"},{name:"Santosh Biradar",id:"s.a.biradar1234@gmail.com"},{name:"Avinas Bidave",id:"a.l.bidave1@gmail.com"},{name:"Umesh Parbhanikar",id:"umeeshpaarbhanikar@gmail.com"}],g.height("4px"),g.color("#fff"),a.databaseSync=!0,f.syncDb(),a.$on("rootScope:READY",function(){console.log("Databse farmerstat is ready"),a.$evalAsync(function(a){a.databaseSync=!1,g.color("#e91e63")})}),a.$on("rootScope:NOTREADY",function(b,c){a.$evalAsync(function(a){a.downloadedPercentage=c/10})}),a.cardTransitionDone=function(a){console.log("This is contact "+JSON.stringify(a))},a.$watch("narrow",function(){if(a.narrow){var b=document.getElementById("drawerPanel");b.className="resets"}else{var b=document.getElementById("drawerPanel");b.className=""}},!0),a.sortemployee=function(){a.showOption=1},a.sortname=function(){a.showOption=2},a.sortvillage=function(){a.showOption=3},a.sortdate=function(){a.showOption=4},a.sortland=function(){a.showOption=5};var j=new PouchDB("farmerlist"),j=f.dbRef(),k=[],l={};g.start();j.allDocs({include_docs:!0},function(b,d){for(var e=0;e<d.rows.length;e++)k.push(d.rows[e].doc);c.timeset(),a.farmers=k,console.log(k),c.groupify(k,l),a.$evalAsync(function(a){console.log(JSON.stringify(l));for(var b in l){var c={};c.label=l[b].label,c.contacts=l[b].contacts,"A"===c.label&&(a.myOption=c),0!=c.label&&a.groups.push(c)}a.loading=!1,g.complete(),"1"==window.localStorage.tutorial_farmer||a.databaseSync||a.CallMe()})});a.onStartChange=function(b){a.date.firstVisit=b,null!==a.date.firstVisit?(a.SearchName={owner:"",name:"",village:""},a.dateFilterOn=!0):(a.date.firstVisit="",i())},a.onEndChange=function(b){a.date.lastVisit=b,null!==a.date.lastVisit?(a.SearchName={owner:"",name:"",village:""},a.dateFilterOn=!0):(a.date.lastVisit="",i())},a.toggleDialog=function(b){a.thumbnail=b;var c=document.querySelector("paper-dialog[transition=paper-dialog-transition-center]");c.toggle()},a.$watch("SearchName.name",function(a,b){a!==b&&d(m,350)}),a.$watch("SearchName.owner",function(b,c){return console.log(b),b!==c?"all"==b?void(a.search.owner=""):void(a.search.owner=b):void 0}),a.$watch("SearchName.village",function(a,b){a!==b&&d(n,350)}),a.$watch("search",function(b){""==b.owner&&""==b.village&&""==b.name?(a.filterOn=!1,console.log("filterOn off")):(a.dateFilterOn=!1,a.fDate=null,a.lDate=null,a.filterOn=!0)},!0),a.$watch("land",function(b){console.log(b),""==b.fland&&""==b.eland||0==b.fland&&0==b.eland?(a.dateFilterOn=!1,console.log("LandfilterOn off")):(a.dateFilterOn=!0,a.SearchName={owner:"",name:"",village:""})},!0);var m=function(){a.search.name=a.SearchName.name,c.timeset()},n=function(){a.search.village=a.SearchName.village,c.timeset()};a.goemp=function(b){console.log("Calling the employee"+b),e.path("employee/"+b+"/visits"),a.$$phase||a.$apply(),g.start()};var o=0;a.CompletedEvent=function(){window.localStorage.tutorial_farmer="1"},a.ExitEvent=function(){console.log("Exit Event called")},a.ChangeEvent=function(){o++},a.BeforeChangeEvent=function(){1===o?(console.log(a.myOption),e.path("/farmer/"+a.myOption.contacts[1].id)):2===o?a.$broadcast("myCustomEvent",{someProp:"Sending you an Object!"}):3===o?a.opened=!0:4===o?a.SearchName.owner=a.officers[a.officers.length-1].id:5===o?(a.showOption=2,a.SearchName.name="Patil"):6===o?(a.SearchName.name="",a.SearchName.owner=""):6===o&&(a.opened=!0)},a.IntroOptions={steps:[{element:document.querySelector("#step1"),intro:"This is farmer list sorted alphabetically, Click on Any to view its details as shown",position:"right"},{element:document.querySelectorAll("#step2")[1],intro:"please select any of Info, Crops, Advices, weather, Map option to view its details",position:"left"},{element:document.querySelectorAll("#step3")[0],intro:"Use any option to filter Data Accordingly.",position:"left"},{element:document.querySelectorAll("#step4")[0],intro:"Now employee filter is selected with all farmers of added by only Umesh Parbhanikar shown.",position:"right"},{element:document.querySelectorAll("#step5")[0],intro:"Another filter Name search is added by which we search for all Patils added only by Umesh Parbhanikar.",position:"right"},{element:document.querySelectorAll("#step5")[0],intro:"Please try other search filters and see results accordingly",position:"right"},{element:document.querySelectorAll("#navMenu")[0],intro:"Here you can navigate to employee profile page, Re-run tutorials and logout",position:"left"}],showStepNumbers:!1,showBullets:!1,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"<strong>NEXT!</strong>",prevLabel:'<span style="color:green">Restart</span>',skipLabel:"Exit",doneLabel:'<span style="color:green">Learned</span>'},a.tuts=function(){o=0,a.CallMe()},a.logout=function(){window.localStorage.user="",h.logout(),e.path("/location")},a.changePassword=function(){e.path("/changepassword")}}]),angular.module("dashboardApp").controller("LoadingCtrl",["Application","$location","Authentication",function(a,b,c){a.registerListener(function(){b.path(c.exists()?"/farmer":"/signin")})}]),angular.module("dashboardApp").controller("AboutCtrl",["$scope","farmerDetail","$state","$location","ngProgress",function(a,b,c,d,e){a.data=b.data[0],console.log("THis is farmer data"+JSON.stringify(b.data[0])),a.cropLength=a.data.crops.length,a.adviceLength=a.data.advices.length,a.tabValue=0,a.$on("changeTab",function(b,c){a.tabValue=c}),a.$watch("tabValue",function(a){if(a+=1)switch(a){case 1:console.log("info page"),c.go("state1.list.info");break;case 2:console.log("crops page"),c.go("state1.list.crops");break;case 3:console.log("advices page"),c.go("state1.list.advices");break;case 4:console.log("weather page"),c.go("state1.list.weather");break;case 5:console.log("Map page"),c.go("state1.list.map")}}),a.goEmployee=function(a){e.start(),d.path("employee/"+a+"/visits")};var f=document.getElementById("card");f.classList.add("translator"),setTimeout(function(){f.classList.remove("translator")},10)}]).controller("InfoCtrl",["$scope",function(a){a.$emit("changeTab",0)}]).controller("CropsCtrl",["$scope","$http","$stateParams",function(a,b,c){a.$emit("changeTab",1),a.Crop=null,console.log(c),b.get("http://ec2-54-68-122-114.us-west-2.compute.amazonaws.com:8081/farmerData/cropData/"+c.id).success(function(b){a.Crop=b[0].crops}).error(function(){alert("There is error occured while fetching Crop image")})}]).controller("AdvicesCtrl",["$scope","$http","$stateParams",function(a,b,c){a.$emit("changeTab",2),a.Advice=null,b.get("http://ec2-54-68-122-114.us-west-2.compute.amazonaws.com:8081/farmerData/adviceData/"+c.id).success(function(b){a.Advice=b[0].advices}).error(function(){alert("There is error occured while fetching Crop image")})}]).controller("WeatherCtrl",["$scope","WeatherService",function(a,b){function c(){b.current.byPosition(a.data.latitude,a.data.longitude).then(function(b){a.weather=b,a.weatherIcon="images/"+a.weather.weather[0].icon+".png",console.log("THis is wheater data"+JSON.stringify(a.weather));moment.utc(a.weather.sys.sunrise,"X").format("YYYY-MM-DD")}),b.forecast.byPosition(a.data.latitude,a.data.longitude).then(function(b){for(var c=0;c<b.list.length;c++)a.daycast.day=moment.utc(b.list[c].dt,"X").format("ddd"),a.daycast.date=moment.utc(b.list[c].dt,"X").format("DD-MM"),a.daycast.icon="images/"+b.list[c].weather[0].icon+".png",a.daycast.description=b.list[c].weather[0].description,a.daycast.temp=b.list[c].temp.day,a.daycast.min=b.list[c].temp.min,a.daycast.max=b.list[c].temp.max,a.daycast.rain=b.list[c].rain,a.forecast.push(a.daycast),a.daycast={}})}a.$emit("changeTab",3),a.weather=null,a.forecast=[],a.daycast={},a.day=moment().format("dddd"),a.date=moment().format("MMMM Do YYYY"),c()}]).controller("MapCtrl",["$scope",function(a){a.$emit("changeTab",4),a.map={center:{latitude:a.data.Profile.latitude,longitude:a.data.Profile.longitude},zoom:8}}]),angular.module("dashboardApp").factory("Utils",[function(){var a=null;return{groupify:function(a,b){for(var c,d,c=a.length-1;c>=0;c--)a[c].name&&(d=a[c].name.charAt(0),b[d]||(b[d]={label:d,contacts:[]}),b[d].contacts.push(a[c]))},timeset:function(){a=new Date},timelog:function(){return a}}}]),angular.module("dashboardApp").factory("csvLib",["$http","Database",function(a,b){var c=(b.dbsRef(),{getFarmers:function(){var b=a.get("http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:8081/api/allFarmerList").success(function(a){return a}).error(function(){return alert("There is error occured while fetching farmer data"),null});return b},getEmployee:function(){var b=a.get("data/officer.json").success(function(a){return a}).error(function(){return alert("There is error occured while fetching farmer data"),null});return b},getFarmerDetail:function(b){console.log("Called for farmer with id"+b);var c=(new Date,a.get("http://ec2-54-68-122-114.us-west-2.compute.amazonaws.com:8081/farmerData/farmerStat/"+b).success(function(a){return a}).error(function(){return alert("There is error occured while fetching farmer data"),null}));return c},getEmployeeDetail:function(b){console.log("THis is id"+b);var c=a.get("http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:9090/api/employeeStat/"+b).success(function(a){return console.log("Data fetching done"),a}).error(function(){return console.log("Data fetching error"),alert("There is error occured while fetching employee data"),null});return c},getEmployeeAdvices:function(b){console.log("THis is id"+b);var c=a.get("http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:9090/api/employeeAdvice/"+b).success(function(a){return a}).error(function(){return alert("There is error occured while fetching farmers details data"),null});return c},getEmployeeFarmers:function(b){var c=a.get("http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:9090/api/farmerDataByEmp"+b).success(function(a){return a}).error(function(){return alert("There is error occured while fetching employee data"),null});return c}});return c}]),angular.module("dashboardApp").factory("WeatherService",["$q","$http",function(a,b){var c="http://api.openweathermap.org/data/2.5",d="&callback=JSON_CALLBACK&units=metric",e=function(e){var f=a.defer();return b.jsonp(c+e+d).success(function(a){f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},f=function(a){var b=a;return(void 0===a||null===a||parseInt(a)<1)&&(b=7),b>14&&(b=14),b};return{current:{byPosition:function(a,b){var c="/weather?lat="+a+"&lon="+b;return e(c)},byCity:function(a){var b="/weather?q="+a;return e(b)},byCityId:function(a){var b="/weather?id="+a;return e(b)}},forecast:{byPosition:function(a,b,c,d){var g=f(c),h="/forecast/daily?lat="+a+"&lon="+b+"&cnt="+g+"&mode=json";return e(h)},byCity:function(a,b,c){var d=f(b),g="/forecast/daily?q="+a+"&cnt="+d+"&mode=json";return e(g)},byCityId:function(a,b,c){var d=f(b),g="/forecast/daily?id="+a+"&cnt="+d+"&mode=json";return e(g)}}}}]),angular.module("dashboardApp").directive("croppedImage",function(){return{template:"<div class='center-cropped'></div>",restrict:"E",replace:!0,link:function(a,b,c){var d=c.width,e=c.height;console.log("This is attrs value "+c.width+c.height),b.css("width",d+"px"),b.css("height",e+"px"),b.css("backgroundPosition","center center"),b.css("backgroundRepeat","no-repeat"),b.css("backgroundImage","url('"+c.src+"')"),b.css("border-radius","50%")}}}),angular.module("dashboardApp").filter("employeName",function(){return function(a){var b={"jitusalunkhe86@gmail.com":"Jitendra Salunke","umeeshpaarbhanikar@gmail.com":"Umesh Parbhanikar","a.z.gavand@gmail.com":"Ambadas Gavand","d.k.bargaje1@gmail.com":"Digambar Bargaje","m.s.bajare1@gmail.com":"Mahavir Bajare","sonawanebhaiyya51@gmail.com":"Bhaiyya Sonawane","pattilsandip007@gmail.com":"Sandip Patil","kalyannikam5@gmail.com":"Kalyan Nikam","v.v.pawar12@gmail.com":"Vishal Pawar","millindaaher@gmail.com":"Milind Aher","asayyed123456@gmail.com":"Abbubakar Sayyed","vinodinggle@gmail.com":"Vinod Ingle","anilldeshhmane@gmail.com":"Anil Deshmane","raameshsuuryawanshi@gmail.com":"Ramesh Suryawanshi","brahmdevkadbhane@gmail.com":"Brahmadev Kadbhane","j.d.raut12@gmail.com":"Jayesh Raut","pradeep.pathare12345@gmail.com":"Pradeep Pathare","s.a.biradar1234@gmail.com":"Santosh Biradar","a.l.bidave1@gmail.com":"Avinas Bidave"};for(var c in b)if(c===a)return b[a]}}),angular.module("dashboardApp").controller("EmployeeCtrl",["$scope","$window","$http","$state","$stateParams","employeeDetail","$location","ngProgress","Authentication",function(a,b,c,d,e,f,g,h,i){function j(b){b.id=r++,b.showWindow=!1,b.options={labelContent:"[46,-77]",labelAnchor:"22 0",labelClass:"marker-labels"},b.title=r+"",a.trackedMarkers.push(b)}function k(){console.log("Length....."+a.formatfarmer.length),a.newAdd=a.formatfarmer,console.log(a.formatfarmer);for(var b in a.formatfarmer)l(a.formatfarmer[b])}function l(b){console.log(b);var c={};c.id=t++,c.options={labelContent:"[46,-77]",labelAnchor:"22 0",labelClass:"marker-labels"},c.title=r+"",c.showWindow=!1,c.icon="images/yellow.png",c.latitude=b.latitude,c.longitude=b.longitude,console.log("count...."+s++),a.trackedfarmerMarkers.push(c),console.log(a.trackedMarkers)}function m(){for(var b=null,c=(a.trackedData[0].Mdate,0),d=null,e=null,f=0;f<a.trackedData.length;f++)("0.0"!==e||"0.0"!==a.trackedData[f].Speed)&&(e=a.trackedData[f].Speed,c++,d={},d.latitude=a.trackedData[f].Latitude,d.longitude=a.trackedData[f].Longitude,b=new Date(a.trackedData[f].MDate),d.time=b.getHours()+":"+b.getMinutes(),d.icon="0.0"===a.trackedData[f].Speed?"http://maps.google.com/mapfiles/ms/icons/red-dot.png":"images/green.png",j(d))}function n(b){function c(a){-1===f.indexOf(a)&&f.push(a)}function d(a){-1===e.indexOf(a)&&e.push(a)}var e=[],f=[];for(var g in b.Advice)d(b.Advice[g].farmer);for(var g in b.Farmer)c(b.Farmer[g]._id);var h=[];!function(){function b(b){q.get(b,function(b,c){var d={};d.created_at=c.Profile.created_at,d.latitude=c.Profile.latitude,d.longitude=c.Profile.longitude,d.name=c.Profile.name,d.village=c.Profile.village,a.revisits.push(d),l(d)})}for(var c in e)-1===f.indexOf(e[c])&&(h.push(e[c]),console.log(e[c]),b(e[c]));k()}()}function o(){c({method:"GET",url:"http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:9090/rangeActivity/"+a.format+"/"+a.format+"/"+a.employeeName}).success(function(b){var c=b;console.log(b),a.formatfarmer=b.Farmer,a.revisits=[],n(c)}).error(function(){})}function p(){for(var a=b.innerHeight,c=document.getElementsByTagName("core-header-panel"),d=0;d<c.length;d++)c[d].style.height=a+"px"}a.responsiveWidth="2000px",a.selected=0,a.selectedMode=0,a.tabValue=0,a.employeeDetail=f.data,a.loading=!1,a.newAdd=[],a.revisits=[],a.dataWait="",console.log("THis is employeeDetail"+JSON.stringify(a.employeeDetail)),a.map={control:{},center:{latitude:16.152933333333333,longitude:74.39419833333334},zoom:6,zoom1:8},a.trackedMarkers=[],a.trackedfarmerMarkers=[],a.visitedMarkers=[];var q=new PouchDB("farmerstat");a.currentLocation={},a.selectedDate=null,a.values=[{id:7,value:"7-8 AM"},{id:8,value:"8-9 AM"},{id:9,value:"9-10 AM"},{id:10,value:"10-11 AM"},{id:11,value:"11-12 AM"},{id:12,value:"12-1 PM"},{id:13,value:"1-2 PM"},{id:14,value:"2-3 PM"},{id:15,value:"3-4 PM"},{id:16,value:"4-5 PM"},{id:17,value:"5-6 PM"},{id:18,value:"6-7 PM"},{id:19,value:"7-8 PM"},{id:20,value:"Whole Day"}],a.employeeName=e.id1,c.get("data/officer.json").success(function(b){console.log(b),a.employeeList=b.data;for(var c=0;c<a.employeeList.length;c++)a.employeeList[c].id==a.employeeName&&(a.region=a.employeeList[c].district,a.regionWeather="http://www.imd.gov.in/section/nhac/distforecast/"+a.region+".htm");"1"!=window.localStorage.tutorial_employee&&a.CallMe()}).error(function(){return alert("There is error occured while fetching farmer data"),null}),a.goto=function(a){g.path("/employee/"+a)},a.goemp=function(){g.path("/farmer")},c({method:"GET",url:"http://ec2-54-187-6-49.us-west-2.compute.amazonaws.com:9002/location/"+a.employeeName}).success(function(b){console.log(b),a.currentLocation=b,c({method:"GET",url:"http://maps.googleapis.com/maps/api/geocode/json?latlng="+a.currentLocation.center.latitude+","+a.currentLocation.center.longitude+"&sensor=false"}).success(function(b){console.log("This is currentAddress data"+b.results[0].formatted_address),a.currentAddress=b.results[0].formatted_address}).error(function(){})}).error(function(){}),a.$watch("myValue",function(b){console.log("selected "+a.selected+"newVal"+b),1===b&&(a.selectedMode=0,console.log("scope.selectedMode"+a.selectedMode))}),a.$watch("tabValue",function(b){0==b?(d.go("state2.visits"),console.log(a.myDate)):1==b&&(h.start(),d.go("state2.advices"))}),a.onModelChange=function(b){a.format=moment(b).format("YYYY-MM-DD");var c=b.toString();a.selectedDate=c.substring(4,15),a.loading=!1};var r=1,s=0,t=0;a.fetchData=function(){a.loading=!0,a.trackedData=null,o(),a.dataWait="Please wait till data is fetched",c({method:"GET",url:"http://ec2-54-68-63-185.us-west-2.compute.amazonaws.com:9002/getMove/"+a.employeeName+"/"+a.selectedDate}).success(function(b){a.trackedData=b,a.map.center.latitude=b[0].Latitude,a.map.center.longitude=b[0].Longitude,a.trackedMarkers=[],m()}).error(function(){a.dataWait="No data available for the selected date"})};var u=new google.maps.DirectionsRenderer;a.changeValue=function(b){function c(a,c){var d=8;20===b.id&&(d=60);var e=new Date(a),f=new Date(c),g=(f.getTime()-e.getTime())/1e3/60;return g>d?!0:!1}function d(a,b){g={},g.latitude=parseFloat(a),g.longitude=parseFloat(b),h.latitude!==g.latitude&&h.longitude!==g.longitude&&(console.log("Value of end"+n),null!==n&&(console.log(f),p={},p.location=n,p.stopover=!0,o.push(p)),n={},n=new google.maps.LatLng(g.latitude,g.longitude),h=g)}u.setMap(a.map.control.getGMap());var e=new google.maps.DirectionsService,f=0,g={},h={},i={},j=a.trackedData[0].MDate,k=0,l=null,m=new google.maps.LatLng(parseFloat(a.trackedData[0].Latitude),parseFloat(a.trackedData[0].Longitude)),n=null,o=[],p={};a.totalDistance=0,a.$evalAsync(function(a){for(console.log("Last Date is"+j),k=0;k<a.trackedData.length-1;k++)if(l=new Date(a.trackedData[k].MDate),20===b.id&&c(j,l))j=l,d(a.trackedData[k].Latitude,a.trackedData[k].Longitude);else{if(l.getHours()>parseInt(b.id))break;c(j,a.trackedData[k].MDate)&&l.getHours()==b.id&&(j=a.trackedData[k].MDate,d(a.trackedData[k].Latitude,a.trackedData[k].Longitude))}(null===m||null===n)&&(m=new google.maps.LatLng(parseFloat(a.trackedData[k].Latitude),parseFloat(a.trackedData[k].Longitude)),n=m),i={origin:m,destination:n,waypoints:o,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.IMPERIAL},e.route(i,function(a,b){b==google.maps.DirectionsStatus.OK&&u.setDirections(a)})})},a.toggleDialog=function(b){a.thumbnail=b;var c=document.querySelector("paper-dialog[transition=paper-dialog-transition-center]");c.toggle()},a.toggleDialog1=function(){var a=document.querySelector("paper-dialog[transition=paper-dialog-transition-bottom]");a.toggle()},a.markerDetail=function(b,c){console.log(a.trackedMarkers[c+1])},p(),angular.element(b).bind("resize",function(){return p(),a.$apply()});var v=0;a.CompletedEvent=function(){window.localStorage.tutorial_employee="1"},a.ExitEvent=function(){console.log("Exit Event called")},a.ChangeEvent=function(){v++},a.BeforeChangeEvent=function(){4===v?a.selected=1:4===v&&(a.opened=!0,document.querySelector(".introjs-prevbutton").style.display="inline-block")},a.IntroOptions={steps:[{element:document.querySelector("#card1"),intro:"This sections shows all tracking related information of the employee",position:"right"},{element:document.querySelectorAll("#card2")[0],intro:"This sections shows all farmer details added by employee",position:"left"},{element:document.querySelectorAll("#option1")[0],intro:"View all today&#39;s related work and current Location of employee",position:"left"},{element:document.querySelectorAll("#option2")[0],intro:"View any selected Date related work and tracking information of employee",position:"right"}],showStepNumbers:!1,showBullets:!1,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"<strong>NEXT!</strong>",prevLabel:'<span style="color:green">Previous</span>',skipLabel:"Exit",doneLabel:"Learned"},a.tuts=function(){v=0,a.CallMe()},a.logout=function(){window.localStorage.user="",i.logout(),g.path("/signin")},a.changePassword=function(){g.path("/changepassword")}}]),angular.module("dashboardApp").directive("resize",["$window",function(a){return function(b){return b.initializeWindowSize=function(){return b.windowHeight=a.innerHeight,b.windowHeight=a.innerHeight},b.initializeWindowSize(),angular.element(a).bind("resize",function(){return b.initializeWindowSize(),b.$apply()})}}]),angular.module("dashboardApp").controller("EinfoCtrl",["$scope","$stateParams","$http","$location","$debounce","ngProgress",function(a,b,c,d,e,f){a.tabValue=0,a.selectedView=0,a.farmer=null,a.map1={control:{},center:{latitude:16.152933333333333,longitude:74.39419833333334},zoom:8,zoom1:8},a.SearchName={name:"",village:""},a.search={name:"",village:""},a.showOption=1;var g=new Date;c.get("http://ec2-54-191-5-178.us-west-2.compute.amazonaws.com:9090/api/farmerDataByEmp/"+b.id1).success(function(b){var c=new Date;console.log(b),console.log("Time tken to fetch "+(c-g)+"ms"),a.farmers=b,a.map1.center.latitude=b[0].latitude,a.map1.center.longitude=b[0].longitude,f.complete()}).error(function(){alert("There is error occured while fetching farmers details data")}),a.farmerInfo=function(b){a.$evalAsync(function(a){a.farmer=b})},a.viewFarmer=function(a){d.path("farmer/"+a+"/info")},a.$watch("SearchName.name",function(a,b){a!==b&&e(h,350)}),a.$watch("SearchName.village",function(a,b){a!==b&&e(i,350)});var h=function(){a.search.name=a.SearchName.name,Utils.timeset()},i=function(){a.search.village=a.SearchName.village,Utils.timeset()};a.sortname=function(){a.showOption=1},a.sortvillage=function(){a.showOption=2}}]),angular.module("dashboardApp").controller("EadvicesCtrl",["$scope","adviceDetail","ngProgress",function(a,b,c){a.tabValue=1,a.advices=b.data.AdviceTimeline,c.complete()}]),angular.module("dashboardApp").directive("imageClick",function(){return function(a,b){a.thumbnailPicture="Hello beautiful";var c=function(){var b=document.querySelector("paper-dialog[transition=paper-dialog-transition-center]");b.toggle(),a.$evalAsync(function(a){a.thumbnailPicture="Hello beautiful",console.log("$evalAsync"+a.thumbnailPicture)})};b.bind("click",c)}}),angular.module("dashboardApp").filter("product",function(){return function(a){return a.slice(5)}}),angular.module("dashboardApp").directive("postRepeatLog",["$timeout","$log","Utils",function(a,b,c){return function(d){console.log("This is the time loaded"+c.timelog()),d.$last&&a(function(){var a=c.timelog(),d=new Date;b.debug("## DOM rendering list took: "+(d-a)+" ms")})}}]),angular.module("dashboardApp").directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j;return b=angular.element(b),e.css("overflow-y","scroll"),e.css("overflow-x","hidden"),e.css("height","inherit"),i=0,null!=f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return i=parseInt(a,10)}),j=!0,g=!1,null!=f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return j=!a,j&&g?(g=!1,h()):void 0}),a.$on("refreshStart",function(){e.animate({scrollTop:"0"})}),h=function(){var b,c,h,k,l;return b=$(e.children()[0]),c=e.offset().top+e.height(),l=b.offset().top+b.height(),h=l-c,k=h<=e.height()*i,k&&j?a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll):k?g=!0:void 0},e.on("scroll",h),d.$on("$destroy",function(){return b.off("scroll",h)}),c(function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?h():void 0:h()},0)}}}]),angular.module("dashboardApp").factory("$debounce",["$rootScope","$browser","$q","$exceptionHandler",function(a,b,c,d){function e(e,i,j){var k,l,m,n=c.defer(),o=n.promise,p=angular.isDefined(j)&&!j,q=!1;angular.forEach(g,function(a,b){angular.equals(g[b].fn,e)&&(q=!0,m=b)}),q?(f[g[m].timeoutId].reject("bounced"),b.defer.cancel(g[m].timeoutId)):(m=h++,g[m]={fn:e});var r=function(){delete g[m];try{n.resolve(e())}catch(b){n.reject(b),d(b)}p||a.$apply()};return k=b.defer(r,i),g[m].timeoutId=k,l=function(){delete f[o.$$timeoutId]},o.$$timeoutId=k,f[k]=n,o.then(l,l),o}var f={},g={},h=0;return e.cancel=function(a){return a&&a.$$timeoutId in f?(f[a.$$timeoutId].reject("canceled"),b.defer.cancel(a.$$timeoutId)):!1},e}]),angular.module("dashboardApp").filter("daterange",function(){return function(a,b){if(""!=b.lastVisit&&""!=b.firstVisit)for(var c=[],d=null,e=new Date(b.lastVisit),f=new Date(b.firstVisit),g=0;g<a.length;g++)d=null,d=new Date(a[g].lastVisit),e>=d&&d>=f&&(console.log(d),c.push(a[g]));else if(""!=b.firstVisit)for(var c=[],d=null,f=new Date(b.firstVisit),g=0;g<a.length;g++)d=null,d=new Date(a[g].lastVisit),d>=f&&(console.log("found"),c.push(a[g]));else if(""!=b.lastVisit)for(var c=[],d=null,e=new Date(b.lastVisit),g=0;g<a.length;g++)d=null,d=new Date(a[g].lastVisit),e>=d&&(console.log("found"),c.push(a[g]));else c=a;return c}}),angular.module("dashboardApp").filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),angular.module("dashboardApp").filter("landrange",function(){return function(a,b){var c;if(""!=b.fland&&""!=b.eland)for(var c=[],d=0;d<a.length;d++)a[d].total_Land<=b.eland&&a[d].total_Land>=b.fland&&c.push(a[d]);else if(""!=b.eland){console.log("eland");for(var c=[],d=0;d<a.length;d++)a[d].total_Land<=b.eland&&c.push(a[d])}else if(""!=b.fland)for(var c=[],d=0;d<a.length;d++)a[d].total_Land>=b.fland&&c.push(a[d]);else c=a;return c}}),angular.module("dashboardApp").controller("SigninCtrl",["$scope","Authentication","$location","Database",function(a,b,c){a.user={username:"",password:""},a.databaseSync=!1,null!==b.getUser()&&(console.log("Calling from this function"),c.path("/farmer")),a.updatedDb=function(){console.log("updateDb called"),a.databaseSync=!1},a.login=function(){b.requestUser().then(function(){c.path("/farmer")})},a.$watch("user",function(b,c){b!=c&&(a.errors="")},!0)}]),angular.module("dashboardApp").factory("Application",[function(){var a=!1,b=[],c=function(){for(var a=b.length-1;a>=0;a--)b[a]()};return{isReady:function(){return a},makeReady:function(){a=!0,c()},registerListener:function(c){a?c():b.push(c)}}}]),angular.module("dashboardApp").factory("Authentication",["$q","$http","$timeout",function(a,b){var c=null;return{requestUser:function(){var d=a.defer();return b.get("/data/user.json").success(function(a){console.log(a),a&&(c=a),d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},getUser:function(){return c},exists:function(){return null!==c},login:function(d){var e=a.defer();return b.post("http://ec2-54-68-63-185.us-west-2.compute.amazonaws.com:8014/login/",d).success(function(a){a?(c=a.user,window.localStorage.user=JSON.stringify(c),e.resolve(a.user)):e.reject("Given credentials are incorrect")}).error(function(a){e.reject(a)}),e.promise},registerUser:function(c){var d=a.defer();return b.post("http://ec2-54-68-63-185.us-west-2.compute.amazonaws.com:8014/changePassword/",c).success(function(){d.resolve()}).error(function(a){d.reject(a)
}),d.promise},logout:function(){c=null},isMain:function(){return this.exists()&&"main"===c.role}}}]),angular.module("dashboardApp").factory("Routefilter",["$location",function(a){var b=[],c=function(a){for(var c=b.length-1;c>=0;c--)for(var e=b[c].routes.length-1;e>=0;e--)if(d(b[c].routes[e],a))return b[c]},d=function(a,b){if(console.log("filterRoute"+a+"route"+b),b instanceof RegExp)return console.log("instanceof"+b),b.test(a);var c=b===a;return console.log("Truth value reoprting "+c),c};return{canAccess:function(a){var b=c(a);return b.callback()},register:function(a,c,d,e){e="undefined"!=typeof e?e:null,b.push({name:a,routes:c,callback:d,redirectUrl:e})},run:function(b){console.log("Before getFilter"+b),b=b.replace(/(.)\/.*/,"$1");var d=c(b);console.log("After getFilter"+JSON.stringify(d)),null!=d&&null!=d.redirectUrl&&(d.callback()||a.path(d.redirectUrl))}}}]),angular.module("dashboardApp").factory("Database",["$location","$rootScope",function(a,b){function c(){a.path("/farmer"),b.$$phase||b.$apply()}var d=new PouchDB("farmerlist"),e=new PouchDB("farmerstat"),f=0;return{canAccess:function(a){var b=getFilter(a);return b.callback()},dbRef:function(){return console.log("Returning db reference"),d},dbsRef:function(){return e},run:function(){c()},syncDbSignin:function(){PouchDB.sync("farmerlist","http://ec2-54-68-16-23.us-west-2.compute.amazonaws.com:5984/farmerlist",{live:!0}).on("change",function(){console.log("change")}).on("complete",function(){console.log("Done sync")}).on("uptodate",function(){var a=new PouchDB("farmerlist");a.allDocs(function(a,b){f=b.total_rows,console.log("Called uptodate"+f),f>1e3&&c()})}).on("error",function(a){console.log(a)})},syncDb:function(){PouchDB.sync("farmerlist","http://ec2-54-68-16-23.us-west-2.compute.amazonaws.com:5984/farmerlist",{live:!0}).on("change",function(){console.log("change")}).on("complete",function(){console.log("Done sync")}).on("uptodate",function(){}).on("error",function(a){console.log(a)}),PouchDB.sync("farmerstat","http://ec2-54-68-16-23.us-west-2.compute.amazonaws.com:5984/farmerstat",{live:!0}).on("change",function(){}).on("complete",function(){console.log("Done sync")}).on("uptodate",function(){var a=new PouchDB("farmerstat");a.allDocs(function(a,c){f=c.total_rows,console.log("Called uptodate"+f),f>1e3?b.$broadcast("rootScope:READY","READY"):b.$broadcast("rootScope:NOTREADY",f)})}).on("error",function(a){console.log(a)})}}}]),angular.module("dashboardApp").controller("SignupCtrl",["$scope","Authentication","$location",function(a,b,c){a.user={username:"",password:"",passwordConfirm:"",oldPassword:""};var d=null;d=b.getUser(),null!==d&&(a.user.username=d.username,a.showOldpassword=!0),a.login=function(d){var e={};e.username=d.username,e.oldPassword=a.showOldpassword?d.oldPassword:"imt",e.newPassword=d.password,b.registerUser(e).then(function(){c.path("/signin")},function(b){a.errors=b})},a.$watch("user.passwordConfirm",function(b){a.passwordMatch=b===a.user.password?!0:!1}),a.$watch("user",function(b,c){b!=c&&(a.errors="")},!0)}]),angular.module("dashboardApp").directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"="},link:function(a,b,c,d){a.$watch(function(){var b;return(a.passwordVerify||d.$viewValue)&&(b=a.passwordVerify+"_"+d.$viewValue),b},function(b){b&&d.$parsers.unshift(function(b){var c=a.passwordVerify;return c!==b?void d.$setValidity("passwordVerify",!1):(d.$setValidity("passwordVerify",!0),b)})})}}}),angular.module("dashboardApp").filter("date",function(){return function(a){var b=moment(a).format("MMMM Do YYYY");return b}});